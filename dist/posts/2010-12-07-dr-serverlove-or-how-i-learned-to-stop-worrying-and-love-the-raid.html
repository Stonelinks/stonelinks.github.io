<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Dr. Serverlove, or How I Learned to Stop Worrying and Love the RAID | Stonelinks</title>

    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400italic,400,700">
    <link rel="stylesheet" href="../assets/css/main.css">

    <!--[if lt IE 9]>
      <script src="../assets/html5shiv/dist/html5shiv.min.js"></script>
      <script src="../assets/respond/dest/respond.min.js"></script>
    <![endif]-->

    <script src="../assets/vendor/jquery/jquery.min.js"></script>
    <script src="../assets/vendor/underscore/underscore.js"></script>
    <script type="text/javascript">
      window.ASSETS = '../assets';
      window.BASENAME = '2010-12-07-dr-serverlove-or-how-i-learned-to-stop-worrying-and-love-the-raid';
      window.BG_IMAGES = 'dist/assets/img/backgrounds/0GBq3.jpg,dist/assets/img/backgrounds/1021101552.jpg,dist/assets/img/backgrounds/121027_162023_000.jpg,dist/assets/img/backgrounds/1780754_589564401120703_639857649_n (1).jpg,dist/assets/img/backgrounds/1979230_10152035339809685_1025831531_o.jpg,dist/assets/img/backgrounds/2000-01-01 08.30.12.jpg,dist/assets/img/backgrounds/2010-08-19 19.25.57.jpg,dist/assets/img/backgrounds/2010-08-21 01.04.54.jpg,dist/assets/img/backgrounds/2011-04-23_07-35-15_846.jpg,dist/assets/img/backgrounds/2012-05-21_12-21-51_382.jpg,dist/assets/img/backgrounds/2012-06-13_11-30-01_10.jpg,dist/assets/img/backgrounds/2012-06-13_13-04-51_940.jpg,dist/assets/img/backgrounds/2012-12-02 00.41.05.jpg,dist/assets/img/backgrounds/2012-12-06 15.09.02.jpg,dist/assets/img/backgrounds/2013-03-03 17.53.11.jpg,dist/assets/img/backgrounds/2013-05-01 08.31.27.jpg,dist/assets/img/backgrounds/2013-05-18 13.07.32.jpg,dist/assets/img/backgrounds/2013-08-22 13.00.42.jpg,dist/assets/img/backgrounds/2013-08-30 18.41.41.jpg,dist/assets/img/backgrounds/2013-08-30 19.58.14.jpg,dist/assets/img/backgrounds/2013-09-20 05.09.53.jpg,dist/assets/img/backgrounds/2013-09-20 05.26.41.jpg,dist/assets/img/backgrounds/2013-09-20 05.30.41.jpg,dist/assets/img/backgrounds/2013-09-20 05.32.01.jpg,dist/assets/img/backgrounds/2013-11-24 18.07.08.jpg,dist/assets/img/backgrounds/2013-11-24 19.05.27.jpg,dist/assets/img/backgrounds/2013-11-25 15.04.06.jpg,dist/assets/img/backgrounds/2013-12-20 14.27.13.jpg,dist/assets/img/backgrounds/2013-12-28 19.16.24.jpg,dist/assets/img/backgrounds/2048 (1).jpg,dist/assets/img/backgrounds/2048.jpg,dist/assets/img/backgrounds/2700262886_6b0fd48dc8_b.jpg,dist/assets/img/backgrounds/3248918413_1deff78256_o.jpg,dist/assets/img/backgrounds/34DnPmX.jpg,dist/assets/img/backgrounds/495251.jpg,dist/assets/img/backgrounds/5bml6q6.jpg,dist/assets/img/backgrounds/5gn0Uw6.jpg,dist/assets/img/backgrounds/75MtJTF.jpg,dist/assets/img/backgrounds/7SqL0BC.jpg,dist/assets/img/backgrounds/7jWBoem.jpg,dist/assets/img/backgrounds/A52It0Q.jpg,dist/assets/img/backgrounds/AYmUVEm.jpg,dist/assets/img/backgrounds/CWA87fd.jpg,dist/assets/img/backgrounds/CcMlC0x.jpg,dist/assets/img/backgrounds/DQBkjl0.jpg,dist/assets/img/backgrounds/Dtd8OaS.jpg,dist/assets/img/backgrounds/EWwV235.jpg,dist/assets/img/backgrounds/Eourq.jpg,dist/assets/img/backgrounds/FDoNLz1.jpg,dist/assets/img/backgrounds/GkWIkzl.jpg,dist/assets/img/backgrounds/GpCUV.jpg,dist/assets/img/backgrounds/IMG_1142 copy-X2.jpg,dist/assets/img/backgrounds/IMG_20120721_181258.jpg,dist/assets/img/backgrounds/IMG_20120825_201522.jpg,dist/assets/img/backgrounds/IPwZZ29.jpg,dist/assets/img/backgrounds/IQgb2Fb.jpg,dist/assets/img/backgrounds/IZyTICW.jpg,dist/assets/img/backgrounds/IijALtC.jpg,dist/assets/img/backgrounds/J8Oqyyd.jpg,dist/assets/img/backgrounds/KBMGZnm.jpg,dist/assets/img/backgrounds/MbN1OhC.jpg,dist/assets/img/backgrounds/NIkQVMz.jpg,dist/assets/img/backgrounds/ONn4OVE.jpg,dist/assets/img/backgrounds/PeoCslF.jpg,dist/assets/img/backgrounds/TUZyh.jpg,dist/assets/img/backgrounds/UP_EMD_SD9043AC_Joso_Bridge_USA.jpg,dist/assets/img/backgrounds/Up2Vo3r.jpg,dist/assets/img/backgrounds/XYWsmJC.jpg,dist/assets/img/backgrounds/Xn25v.jpg,dist/assets/img/backgrounds/XvkHfUA.jpg,dist/assets/img/backgrounds/YseOPg6.jpg,dist/assets/img/backgrounds/bHVlqeR.jpg,dist/assets/img/backgrounds/bXTsleX.jpg,dist/assets/img/backgrounds/d7t5BrZ.jpg,dist/assets/img/backgrounds/desert_city.jpg,dist/assets/img/backgrounds/enukwns.jpg,dist/assets/img/backgrounds/fr42b.jpg,dist/assets/img/backgrounds/hTkXfEY.jpg,dist/assets/img/backgrounds/heic0504b.jpg,dist/assets/img/backgrounds/highflight-operationa-go8.jpg,dist/assets/img/backgrounds/k9JWU9N.jpg,dist/assets/img/backgrounds/kQj6gNC.jpg,dist/assets/img/backgrounds/m1gD1NC.jpg,dist/assets/img/backgrounds/m95qL89.jpg,dist/assets/img/backgrounds/mooCZ.jpg,dist/assets/img/backgrounds/n0qGynd.jpg,dist/assets/img/backgrounds/nLpQ2G3.jpg,dist/assets/img/backgrounds/ozjI2XF.jpg,dist/assets/img/backgrounds/pTApMWS.jpg,dist/assets/img/backgrounds/raddmHE.jpg,dist/assets/img/backgrounds/rhvP0wn.jpg,dist/assets/img/backgrounds/s_f02_RTR3FJM0.jpg,dist/assets/img/backgrounds/tmEkJ7Q.jpg,dist/assets/img/backgrounds/uMrsMXh.jpg,dist/assets/img/backgrounds/vmBnAIS.jpg,dist/assets/img/backgrounds/wallpaper-1312831.jpg,dist/assets/img/backgrounds/wallpaper-1441536.jpg,dist/assets/img/backgrounds/wjZsmhr.jpg,dist/assets/img/backgrounds/xkl9FoE.jpg,dist/assets/img/backgrounds/xrH9T22.jpg,dist/assets/img/backgrounds/y4WGD7I.jpg,dist/assets/img/backgrounds/yrZCDd1.jpg,dist/assets/img/backgrounds/ywhjtHh.jpg,dist/assets/img/backgrounds/znfvr.jpg'.split(',');
    </script>
    <script src="../assets/js/main.js"></script>
  </head>
  <body>

    



<div class="landing">
  <a href="../index.html" class="brand"><img src="../assets/img/logos/big-logo.png"> Stonelinks</a>
  <div class="tagline-bar">Lucas Doyle&#x27;s website</div>
</div>

<div class="navbar navbar-default" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">
        <img src="../assets/img/logos/big-logo.png">
        Stonelinks
      </a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
          <a href="/blog.html">Blog</a>
        </li>
        <li>
          <a href="/about.html">About</a>
        </li>
        <li>
          <a href="/projects.html">Projects</a>
        </li>
      </ul>
    </div>
  </div>
</div>


<div class="container">

  

<div class="row post">
  <div class="box">
    <div class="col-lg-12">
      <hr>
      <a id="2010-12-07-dr-serverlove-or-how-i-learned-to-stop-worrying-and-love-the-raid" href="/posts/2010-12-07-dr-serverlove-or-how-i-learned-to-stop-worrying-and-love-the-raid.html">
      <h1 class="intro-text text-center">Dr. Serverlove, or How I Learned to Stop Worrying and Love the RAID
      <br/>
      <small>12/07/2010</small>
      </h1></a>
      <hr>
      

<center>
<img src="../assets/img/posts/downsize-300x225.jpg" class="thumbnail" width="50%">
<br>
These two suckers now live on my desk and throw off a ton of heat.
</center>

<p>Recently completed some much needed upgrades to the servers (hardware and software) that run Stonelinks! This has me very excited and has been a long time in the works! (Warning: long story of blood, sweat, nerdrage and glorious payoff ahead) Despite being a humongous Linux nerd, for years I have hosted Stonelinks using Windows / <a href="http://www.wampserver.com/en/">WAMP</a> server (which is the same thing as LAMP, just replace Linux with Windows). For a long time this was my only option as far as &quot;free&quot; hosting on RPI&#39;s bandwidth goes, as my desktop is the only computer that is consistently on 24/7 and can act like a server.</p>
<p>By necessity, my desktop needs to be running Windows 7 because unfortunately I need access to a bunch of programs that I can&#39;t get for Linux. Things like LabVIEW for work at the <a href="work/work-at-harvard--smithsonian.html">Center for Astrophysics</a>, MATLAB so my room mate can run his week long computational fluid dynamic simulations on for his research (we need our own supercomputer for this!), Solidworks for random CAD I occasionally do, Netflix because content licensing people are afraid of Linux and finally Team Fortress 2 because I occasionally like to get my game on. Because of the sporadic nature of when I use most of these programs, it also means that dual booting between Linux and Windows was is of the question. I didn&#39;t want to shut down the server while someone was using it just so I could boot into Windows and do some CAD.</p>
<p>Therefore, I have stuck with my WAMP setup for many years. As far as WAMP is concerned, it has sort of been &quot;fine&quot; most of the time, but definitely not ideal. All of the other websites I work on are hosted from some flavor of Linux, as it is free, stable, makes administration and development a breeze compared to Windows (what a nightmare it was to get PHP&#39;s mail() command to work with SSL in Windows), the list goes on. Obviously hosting Stonelinks under Linux has been a goal of mine. Occasionally I would try using a virtual machine to host, but I&#39;d always find that to be too resource intensive and would BSOD my computer after awhile if left on for too long. Cygwin was and always has been a nightmare for me, so I didn&#39;t even go there. Interestingly, I did have some success with something called <a href="http://www.andlinux.org/">andLinux</a> which, from my understanding, is an Ubuntu installation based around a Linux kernel compiled to use win32 executables a la <a href="http://www.colinux.org/">coLinux</a>. All the benefits of a virtual machine without the instability and losing a massive chunk of RAM. I ultimately dumped andLinux, chiefly because andLinux uses a virtual network adapter to communicate with Windows, so a webserver running under andLinux would be heavily bandwidth constrained for any clients other than localhost. So up until writing this I&#39;ve been really, throughly stuck.</p>
<p>Fast forward to a few weeks before Christmas. For an early Christmas present, I decided to replace my Dad&#39;s aging Dell with a Newegg special custom desktop. I built him a pretty sweet machine, and even got him using Ubuntu (quite the tech-savvy 63 year old!), with a Windows XP virtual machine to fall back on if he ever gets really stuck with something. This left his old desktop vacated for me to use! The Dell made it&#39;s glorious pilgrimage back to RPI with me where I proceeded to wipe it&#39;s brains and installed the latest Ubuntu on it. I then began the task of porting Stonelinks over to that machine. One problem though: my Dad&#39;s old Dell did not have enough disk space for it. Queue my second Newegg purchase: I bought two 2-TB SATA disks and a RAID card (among other things) on cyber Monday for the crazy price of $180 (granted the RAID card is not a &quot;real&quot; RAID card, as none of the parity checking for RAID is done by hardware on the card it is basically a glorified SATA controller). I wrongfully assumed that since the RAID card was PCI, it would be compatible with the old Dell. I thought that since there were no SATA ports on the motherboard of the Dell I could use the RAID card to be the root of the webserver. At the very worst, I knew the firmware on the card was swappable so I could re-flash firmware on the card to make it act as a pass through (no RAID) for the drives to the OS. Booooy was I wrong.</p>
<p>First of all, the RAID controller was not being picked up, not even in the BIOS, on the Dell. No matter what I tried, it wouldn&#39;t work in the Dell (and yes I had the Linux drivers for it / proper kernel modules running). I thought I might have a defective card so I tried it in a spare PCI slot on my desktop. The card worked like a charm! At this point I was tearing my hair out -- I didn&#39;t even care about RAID on the card, I just wanted SATA drives to work on the Dell at which point I could use something like <a href="http://en.wikipedia.org/wiki/Mdadm">mdadm</a> for my fake RAID. I thought that flashing the firmware that makes the card act like a pass through was a good idea. This opened up a new can of nightmares for me!</p>
<p>Turns out that Silicon Image (SI from here on out), the maker of the &quot;fake&quot; RAID controller chip on the card I bought, supplies its chips / firmware to 3rd parties that put together the cards and sell them. In order to even begin messing with the firmware on the card I had to use a bunch of really bad DOS executables that I called from the command line, and then echo the return value (took me forever to figure out how to do... damn windows shell) so I could match the number up with the response code on some PDF off their website. At this point I am furious that I&#39;ve wasted so much time on this. Using the sinfully awful SI tools, I eventually figured out that my card manufacturer, Rosewill, was storing the device firmware on an external flash chip that I could not flash with any different firmware.</p>
<p>At this point I have not slept in probably 24 hours and am feeling like I want to skewer the card on my African war sword (yes I own one) throw it in the oven, set it to clean and walk away. I am too stubborn to give up like that though, so I cook up a phenomenal, and what will be my final, solution to hosting this iteration of Stonelinks.</p>
<p>Essentially, I separated content from the servers by keeping the RAID array on my desktop, sharing it as a Windows share, and then using <a href="https://help.ubuntu.com/community/Autofs">autofs</a> to mount the share on the Dell. Both machines live behind the same 10/100 switch and I can pull data off there at fairly high speeds, so I was very happy! The hardest part about getting this to work was managing permissions between the two machines and finding a good way to keep track of my Desktop because its IP was no longer static. I accomplished the former by being clever, and the latter with a dynamic DNS. Overall, I&#39;d say the lessons I learned from this were things I already knew but were reinforced:</p>
<ul>
<li>Don&#39;t buy something (RAID card in this case) just because it is cheap</li>
<li>Don&#39;t make assumptions about how something will work</li>
<li>Instead of trying solve a complicated problem all at once and banging your head against the wall, stay sane and walk away, then come back and attack it bit by bit</li>
</ul>



    </div>
  </div>
</div>


</div>



<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-12 text-center">
              
                <a class="social" href="https://www.facebook.com/stonelinks" target="_blank">
                  <i class="fa fa-facebook"></i>
                </a>
              
                <a class="social" href="https://github.com/Stonelinks" target="_blank">
                  <i class="fa fa-github"></i>
                </a>
              
                <a class="social" href="https://twitter.com/#!/Stonelinks" target="_blank">
                  <i class="fa fa-twitter"></i>
                </a>
              
                <a class="social" href="https://plus.google.com/116178490514652721625/posts" target="_blank">
                  <i class="fa fa-google-plus"></i>
                </a>
              
                <a class="social" href="http://www.linkedin.com/pub/lucas-doyle/25/550/169" target="_blank">
                  <i class="fa fa-linkedin"></i>
                </a>
              
                <a class="social" href="http://www.youtube.com/user/RealStonelinks" target="_blank">
                  <i class="fa fa-youtube"></i>
                </a>
              
              <a class="footer-link" href="">
                contact
              </a>
            </div>
        </div>
    </div>
</footer>



  </body>
</html>
