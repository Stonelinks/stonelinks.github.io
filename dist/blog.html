<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Blog | Stonelinks</title>

    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400italic,400,700">
    <link rel="stylesheet" href="assets/css/main.css">

    <!--[if lt IE 9]>
      <script src="assets/html5shiv/dist/html5shiv.min.js"></script>
      <script src="assets/respond/dest/respond.min.js"></script>
    <![endif]-->

    <script src="assets/vendor/jquery/jquery.min.js"></script>
    <script src="assets/vendor/underscore/underscore.js"></script>
    <script type="text/javascript">
      window.ASSETS = 'assets';
      window.BASENAME = 'blog';
      window.BG_IMAGES = 'dist/assets/img/backgrounds/0GBq3.jpg,dist/assets/img/backgrounds/1021101552.jpg,dist/assets/img/backgrounds/121027_162023_000.jpg,dist/assets/img/backgrounds/1780754_589564401120703_639857649_n (1).jpg,dist/assets/img/backgrounds/1979230_10152035339809685_1025831531_o.jpg,dist/assets/img/backgrounds/2000-01-01 08.30.12.jpg,dist/assets/img/backgrounds/2010-08-19 19.25.57.jpg,dist/assets/img/backgrounds/2010-08-21 01.04.54.jpg,dist/assets/img/backgrounds/2011-04-23_07-35-15_846.jpg,dist/assets/img/backgrounds/2012-05-21_12-21-51_382.jpg,dist/assets/img/backgrounds/2012-06-13_11-30-01_10.jpg,dist/assets/img/backgrounds/2012-06-13_13-04-51_940.jpg,dist/assets/img/backgrounds/2012-12-02 00.41.05.jpg,dist/assets/img/backgrounds/2012-12-06 15.09.02.jpg,dist/assets/img/backgrounds/2013-03-03 17.53.11.jpg,dist/assets/img/backgrounds/2013-05-01 08.31.27.jpg,dist/assets/img/backgrounds/2013-05-18 13.07.32.jpg,dist/assets/img/backgrounds/2013-08-22 13.00.42.jpg,dist/assets/img/backgrounds/2013-08-30 18.41.41.jpg,dist/assets/img/backgrounds/2013-08-30 19.58.14.jpg,dist/assets/img/backgrounds/2013-09-20 05.09.53.jpg,dist/assets/img/backgrounds/2013-09-20 05.26.41.jpg,dist/assets/img/backgrounds/2013-09-20 05.30.41.jpg,dist/assets/img/backgrounds/2013-09-20 05.32.01.jpg,dist/assets/img/backgrounds/2013-11-24 18.07.08.jpg,dist/assets/img/backgrounds/2013-11-24 19.05.27.jpg,dist/assets/img/backgrounds/2013-11-25 15.04.06.jpg,dist/assets/img/backgrounds/2013-12-20 14.27.13.jpg,dist/assets/img/backgrounds/2013-12-28 19.16.24.jpg,dist/assets/img/backgrounds/2048 (1).jpg,dist/assets/img/backgrounds/2048.jpg,dist/assets/img/backgrounds/2700262886_6b0fd48dc8_b.jpg,dist/assets/img/backgrounds/3248918413_1deff78256_o.jpg,dist/assets/img/backgrounds/34DnPmX.jpg,dist/assets/img/backgrounds/495251.jpg,dist/assets/img/backgrounds/5bml6q6.jpg,dist/assets/img/backgrounds/5gn0Uw6.jpg,dist/assets/img/backgrounds/75MtJTF.jpg,dist/assets/img/backgrounds/7SqL0BC.jpg,dist/assets/img/backgrounds/7jWBoem.jpg,dist/assets/img/backgrounds/A52It0Q.jpg,dist/assets/img/backgrounds/AYmUVEm.jpg,dist/assets/img/backgrounds/CWA87fd.jpg,dist/assets/img/backgrounds/CcMlC0x.jpg,dist/assets/img/backgrounds/DQBkjl0.jpg,dist/assets/img/backgrounds/Dtd8OaS.jpg,dist/assets/img/backgrounds/EWwV235.jpg,dist/assets/img/backgrounds/Eourq.jpg,dist/assets/img/backgrounds/FDoNLz1.jpg,dist/assets/img/backgrounds/GkWIkzl.jpg,dist/assets/img/backgrounds/GpCUV.jpg,dist/assets/img/backgrounds/IMG_1142 copy-X2.jpg,dist/assets/img/backgrounds/IMG_20120721_181258.jpg,dist/assets/img/backgrounds/IMG_20120825_201522.jpg,dist/assets/img/backgrounds/IPwZZ29.jpg,dist/assets/img/backgrounds/IQgb2Fb.jpg,dist/assets/img/backgrounds/IZyTICW.jpg,dist/assets/img/backgrounds/IijALtC.jpg,dist/assets/img/backgrounds/J8Oqyyd.jpg,dist/assets/img/backgrounds/KBMGZnm.jpg,dist/assets/img/backgrounds/MbN1OhC.jpg,dist/assets/img/backgrounds/NIkQVMz.jpg,dist/assets/img/backgrounds/ONn4OVE.jpg,dist/assets/img/backgrounds/PeoCslF.jpg,dist/assets/img/backgrounds/TUZyh.jpg,dist/assets/img/backgrounds/UP_EMD_SD9043AC_Joso_Bridge_USA.jpg,dist/assets/img/backgrounds/Up2Vo3r.jpg,dist/assets/img/backgrounds/XYWsmJC.jpg,dist/assets/img/backgrounds/Xn25v.jpg,dist/assets/img/backgrounds/XvkHfUA.jpg,dist/assets/img/backgrounds/YseOPg6.jpg,dist/assets/img/backgrounds/bHVlqeR.jpg,dist/assets/img/backgrounds/bXTsleX.jpg,dist/assets/img/backgrounds/d7t5BrZ.jpg,dist/assets/img/backgrounds/desert_city.jpg,dist/assets/img/backgrounds/enukwns.jpg,dist/assets/img/backgrounds/fr42b.jpg,dist/assets/img/backgrounds/hTkXfEY.jpg,dist/assets/img/backgrounds/heic0504b.jpg,dist/assets/img/backgrounds/highflight-operationa-go8.jpg,dist/assets/img/backgrounds/k9JWU9N.jpg,dist/assets/img/backgrounds/kQj6gNC.jpg,dist/assets/img/backgrounds/m1gD1NC.jpg,dist/assets/img/backgrounds/m95qL89.jpg,dist/assets/img/backgrounds/mooCZ.jpg,dist/assets/img/backgrounds/n0qGynd.jpg,dist/assets/img/backgrounds/nLpQ2G3.jpg,dist/assets/img/backgrounds/ozjI2XF.jpg,dist/assets/img/backgrounds/pTApMWS.jpg,dist/assets/img/backgrounds/raddmHE.jpg,dist/assets/img/backgrounds/rhvP0wn.jpg,dist/assets/img/backgrounds/s_f02_RTR3FJM0.jpg,dist/assets/img/backgrounds/tmEkJ7Q.jpg,dist/assets/img/backgrounds/uMrsMXh.jpg,dist/assets/img/backgrounds/vmBnAIS.jpg,dist/assets/img/backgrounds/wallpaper-1312831.jpg,dist/assets/img/backgrounds/wallpaper-1441536.jpg,dist/assets/img/backgrounds/wjZsmhr.jpg,dist/assets/img/backgrounds/xkl9FoE.jpg,dist/assets/img/backgrounds/xrH9T22.jpg,dist/assets/img/backgrounds/y4WGD7I.jpg,dist/assets/img/backgrounds/yrZCDd1.jpg,dist/assets/img/backgrounds/ywhjtHh.jpg,dist/assets/img/backgrounds/znfvr.jpg'.split(',');
    </script>
    <script src="assets/js/main.js"></script>
  </head>
  <body>

    



<div class="landing">
  <a href="index.html" class="brand"><img src="assets/img/logos/big-logo.png"> Stonelinks</a>
  <div class="tagline-bar">Lucas Doyle&#x27;s website</div>
</div>

<div class="navbar navbar-default" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">
        <img src="assets/img/logos/big-logo.png">
        Stonelinks
      </a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
          <a href="/blog.html">Blog</a>
        </li>
        <li>
          <a href="/about.html">About</a>
        </li>
        <li>
          <a href="/projects.html">Projects</a>
        </li>
      </ul>
    </div>
  </div>
</div>


<div class="container">

  

<div id="blog-anchor">
</div>

<script type="text/javascript">
  window.POSTS = [
    
      {
        id: '2013-01-06-new-resume',
        title: 'New Resume',
        date: '01/06/2013'
      },
    

      {
        id: '2012-07-24-webgl_blox',
        title: 'WebGL Blox',
        date: '07/24/2012'
      },
    

      {
        id: '2012-04-30-lite-write',
        title: 'How I do Word Processing',
        date: '04/30/2012'
      },
    

      {
        id: '2012-04-22-new-drone',
        title: 'New Aerial Drone',
        date: '04/22/2012'
      },
    

      {
        id: '2012-03-27-first-contribution-to-opensource',
        title: 'Contribution to Open Source Software',
        date: '03/27/2012'
      },
    

      {
        id: '2012-01-02-sudoku-solver',
        title: 'Sudoku Solver',
        date: '01/02/2012'
      },
    

      {
        id: '2011-03-14-binocular-face-tracking-sneak-peek',
        title: 'Binocular Face Tracking Sneak Peek',
        date: '03/14/2011'
      },
    

      {
        id: '2011-03-14-active-face-tracking-with-stonebot',
        title: 'Active Face Tracking with Stonebot',
        date: '03/14/2011'
      },
    

      {
        id: '2011-02-03-execute-time-and-plot-c-programs-with-python',
        title: 'Execute, Time and Plot C++ Programs with Python',
        date: '02/03/2011'
      },
    

      {
        id: '2011-01-26-rudimentary-gmailbased-print-server',
        title: 'Rudimentary Gmail-based Print Server',
        date: '01/26/2011'
      },
    

      {
        id: '2011-01-07-a-more-accurate-coordinate-system',
        title: 'A More Accurate Coordinate System',
        date: '01/07/2011'
      },
    

      {
        id: '2010-12-22-electromagnets-how-do-they-work',
        title: 'Electromagnets, How do They Work?',
        date: '12/22/2010'
      },
    

      {
        id: '2010-12-21-stonelinks-hosted-at-my-house',
        title: 'Stonelinks Hosted at my House',
        date: '12/21/2010'
      },
    

      {
        id: '2010-12-07-dr-serverlove-or-how-i-learned-to-stop-worrying-and-love-the-raid',
        title: 'Dr. Serverlove, or How I Learned to Stop Worrying and Love the RAID',
        date: '12/07/2010'
      },
    

      {
        id: '2010-11-25-documentation-is-done',
        title: 'Documentation is done',
        date: '11/25/2010'
      },
    

      {
        id: '2010-11-22-labview-custom-documentation-formats',
        title: 'LabVIEW Custom Documentation Formats',
        date: '11/22/2010'
      },
    

      {
        id: '2010-11-22-latex-is-fun',
        title: 'Latex is Fun',
        date: '11/22/2010'
      },
    

      {
        id: '2010-11-12-door-mounted-roboschwarzenegger',
        title: 'Door Mounted Robo Schwarzenegger',
        date: '11/12/2010'
      },
    

      {
        id: '2010-09-30-windows-based-webcam-control-software',
        title: 'Windows Based Webcam Control Software',
        date: '09/30/2010'
      },
    

      {
        id: '2014-06-07-looking-back',
        title: 'Recursive Directory Lister',
        date: '09/30/2010'
      },
    
  ]
</script>

<div class="hide"></div>
  
    <div id="post-content-2013-01-06-new-resume">
      <p>Over the holidays I finally got around to implementing what I wish existed back when I was looking for a job: a quick, easy, flexible way to write and publish a resume in many formats. The more people who see your resume, the better your chances of getting an interview or call back from a potential employer. This means the more formats and places that your resume is viewable in, the better. When I was looking for a job, I tried to follow this strategy but quickly tired making the same change on multiple versions of my resume in different formats.</p>
<p>Like any programmer that has to do anything more than once, I wanted to automate this tedious editing. So I endeavoured create a better reseume authoring solution. Specifically, I wanted these features:</p>
<ul>
<li>Explicit seperation of resume data from resume formatting</li>
<li>Store resume data in an easy to manipulate format</li>
<li>Write once, publish and deploy the resume everywhere</li>
</ul>
<p>I ended up engineering a solution that used a JSON file to store resume data, and a simple python program that would use different &quot;writers&quot; to spit out the resume in different formats. Here is a breakdown of the supported formats using a combination of the generator and some macros in a Makefile:</p>
<ul>
<li>text</li>
<li>html</li>
<li>pdf (using <a href="http://code.google.com/p/wkhtmltopdf/">wkhtmltopdf</a>)</li>
<li>markdown</li>
<li>stonelinks-specific markdown (basically a special markdown template used specifically for the resume on this website)</li>
</ul>
<p>Anyhow it is finished and it works great for my purposes. The code is available <a href="https://github.com/Stonelinks/resume">here</a> on github. It should be easy for others to use it, just fork and modify the JSON with your resume data and have at it!</p>



    </div>
  

    <div id="post-content-2012-07-24-webgl_blox">
      <p>This is a quick and dirty attempt to a clone a really addicting android game called <a href="https://play.google.com/store/apps/details?id=com.entwicklerx.tapblox&amp;hl=en">Tap Blox</a>. Play by eliminating groups of three or more adjacent blocks of the same color. Currently there is no timing / scoring system.</p>
<p>I did this as an educational exercise, mostly to play around with WebGL and improve my skills at Javascript (which I know very little about). Plus programming is fun in general. The WebGL library I used used is Mr. Doob&#39;s excellent <a href="https://github.com/mrdoob/three.js">Three.js</a>. Hope you enjoy! Best results with Google Chrome.</p>


<div class="text-center">
  <a href="blox.html" class="btn btn-info btn-lg" target="_blank">Click here to play</a>
</div>

    </div>
  

    <div id="post-content-2012-04-30-lite-write">
      <p>A few months ago I came up with a quick and dirty way to write text documents. I&#39;m calling it <a href="https://github.com/Stonelinks/Lite-Write">Lite Write</a> because it is so simple. I&#39;ve been using it in place of a word processor for awhile and been very happy with it.</p>
<p>Like most people who write a lot of code, I&#39;m most comfortable manipulating text in my editor of choice. However, I do a fair amount of writing that needs to be accessible to non programmers, which means my work really can&#39;t stay in plain text forever. Lite write is a simple setup (basically a Makefile and some bits of HTML/CSS) that allows you to:</p>
<ul>
<li>Write everything in markdown</li>
<li>Produce a PDF of your document</li>
<li>Produce a standalone HTML version of your document anyone can view online (this works really nice with dropbox)</li>
<li>Simple, easy to extended</li>
</ul>
<p>Over time I&#39;ve grown very frustrated with traditional word processors (MS Word, OpenOffice, etc.). Google Docs is pretty good, but not well suited for when you&#39;re offline or need fine control over formatting. I used LaTeX for awhile because it gave me that control over formatting and produced beautiful looking documents. But while awesome for equations, large amounts of text and so many other things, LaTeX&#39;s syntax felt cumbersome for me and seemed way overkill for shorter documents.</p>
<p>Enter Lite Write. Markdown is simple enough that you don&#39;t even need to think about it when writing, and if you need finer control over formatting, just write HTML. So far has been great, and hopefully other people will read this, use it and maybe even add more formats to it.</p>



    </div>
  

    <div id="post-content-2012-04-22-new-drone">
      <div class="text-center"><iframe width="500px" height="400px" src="http://www.youtube.com/embed/3jVKegQwZ24" frameborder="0" allowfullscreen></iframe></div>

<p>Good news and bad news! The good news is that in the last month or so at RPI, my friend Drew and I were able to cobble together some electronics with my airplane and squeeze in some successful flights of an RC drone! In the video above you can see one of our voyages. I successfully piloted the plane over RPI&#39;s campus for about a half hour until the winds started to pick up and things got messy.</p>


<div class="text-center">

<img src="assets/img/posts/drone.jpg" class="thumbnail" width="80%">

Early mock up of the drone with the wings removed.

The camera has since been mounted to a custom pan/tilt module under the engine.

</div>

<br>
<br>

<p>Which leads to the bad news. The bad news is that it crashed! Or rather I crashed it. Basically the wind was really strong and blew it out of range. We think it took a nose dive several hundred feet into the ground and crashed near Troy Highschool, which was very far away from us. It was lost for two days before we recovered it thanks to <a href="http://www.reddit.com/r/RPI/comments/tj2b2/anyone_seen_a_red_rc_plane_last_seen_doing_a_nose/">Reddit</a>.</p>
<p>The damage was substantial. Besides the airframe being totally trashed, I lost my camera and a brushless motor. Drew faired better, only suffering minor damage to his radio equipment.</p>
<p>Future plans for the drone are:</p>
<ul>
<li>Repair it to pre-crash condition, and never fly in heavy winds again</li>
<li>Make it controllable from a computer (probably with a microcontroller and an Xbee)</li>
<li>Make it autonomously fly! (with GPS, some kind of horizon sensor, accelerometers, gyros etc.)</li>
</ul>
<p>Other cool applications I can think of:</p>
<ul>
<li>Make 3d maps of things (e.g. map my neighborhood by flying around it while saving images with location and orientation of the drone)</li>
<li>Automatically follow things (maybe use another GPS as a beacon or build a classifier for OpenCV)</li>
<li>Go to waypoints and drop things (how cool would it be to stand in the middle of a field and have a candy bar drop from the sky?)</li>
</ul>
<p>At any rate, a fun new experiment!</p>


    </div>
  

    <div id="post-content-2012-03-27-first-contribution-to-opensource">
      <center><iframe width="500px" height="400px" src="http://www.youtube.com/embed/gLsdHmCKoEw" frameborder="0" allowfullscreen></iframe></center>

<p>Up until now, all my contributions to open source have been programs I have written, and as a general practice I like to make all my work open source if I can. However, its a nice feeling to have some code I wrote incorporated into someone else&#39;s project for a change.</p>
<p>The program in question here is called <a href="https://github.com/gnebehay/OpenTLD">OpenTLD</a>. Its a program for tracking objects (not just faces) in unconstrained video streams with NO training data beforehand (TLD stands for Tracking, Learning and Detection). Instead of using precomputed classifiers (like I previously have done with OpenCV), OpenTLD builds a model of what it is supposed to be detecting on the fly. To demonstrate, above is a slightly creepy demo of OpenTLD tracking my face.</p>
<p>The version of OpenTLD here is actually the C++ implementation of OpenTLD. OpenTLD began life as a bunch of <a href="https://github.com/zk00006/OpenTLD">Matlab programs</a> written as part of Zdenek Kalal&#39;s PHD thesis. <a href="http://www.youtube.com/watch?v=1GhNXHCQGsM">Here</a> is a more advanced video by him talking / showing off OpenTLD (he calls it Predator).</p>
<p>But so yeah! <a href="https://github.com/gnebehay/OpenTLD/pull/11">I actually contributed to this</a>! Even though the code I wrote is trivial (it had to do with the bounding box when you first start the program), it still makes me really excited. I plan on taking a closer look at the codebase sometime later and trying to learn how it works. Up until now all my contributions to open source have been programs I have written. It feels really cool to have a change I made rolled into this super advanced computer vision program!</p>


    </div>
  

    <div id="post-content-2012-01-02-sudoku-solver">
      <p>I got really bored over the holidays and wrote a very naive sudoku solver in C++.</p>
<p>See it on github: <a href="https://gist.github.com/1522578"><a href="https://gist.github.com/1522578">https://gist.github.com/1522578</a></a></p>



    </div>
  

    <div id="post-content-2011-03-14-binocular-face-tracking-sneak-peek">
      <p>The code needs a little more polish before I&#39;m happy releasing it, but here is a demo video of the latest incarnation of the &#39;bot doing some binocular face detection and tracking. For added fun (and in honor of <a href="http://www.thinkwithportals.com/">Portal 2</a> which comes out this week), I have it playing context-aware sound clips from the turrets in the game when it spots people or loses track of them.</p>


<center>
<iframe width="80%" height="400px" src="http://www.youtube.com/embed/MACHkIpAZ_w" frameborder="0" allowfullscreen></iframe>
</center>

    </div>
  

    <div id="post-content-2011-03-14-active-face-tracking-with-stonebot">
      <p>I finally have it working! Very excited as I write this. So glad spring break exists otherwise I&#39;d never have the time for this. Long story short, I have face detection working on my personal robot. Check out the video to see it in action.</p>


<center>
<iframe width="80%" height="400px" src="http://www.youtube.com/embed/RRwMJ8GYT7Y" frameborder="0" allowfullscreen></iframe>
</center>

<p>This has been a goal of mine ever since I started building my personal robot (which, in keeping with the Stonelinks legacy, shall henceforth be known as &quot;Stonebot&quot;). This face tracking makes use of my <a href="a-more-accurate-coordinate-system.html">new method for positioning the camera</a> that I worked on a little over winter break, and is probably the most complicated piece of python I have written to date. Here are some highlights of the project:</p>
<h2 id="opencv">OpenCV</h2>
<p>By far, the hardest thing about this was getting OpenCV set up correctly. Once set up, it is relatively easy to use, comes with a lot of cool examples and seems extremely powerful (if you don&#39;t believe me check out what the folks over at <a href="http://www.willowgarage.com/">Willow Garage</a> do with it on a routine basis). In the future it is definitely something I want to experiment more with, and not just use for face and object detection.</p>
<p>So a summary of the build process: If you&#39;re like me and running Ubuntu 10.04, you&#39;ll want to save some time from having to compile OpenCV from source (especially if you are on a 900MHz single core eee pc like I originally was). Unfortunately, the most recent version of OpenCV is 2.2 while the latest version in the official Ubuntu repos it is only 2.0. Now normally I would not care about using an older version of the same library, however when I looked at the python examples for 2.2, 2.1 and 2.0, things looked much cleaner in 2.2 and 2.1 (you can import everything under the single namespace using <code>import cv</code> in 2.1 on up for example).</p>
<p>Additionally, presumably the newer the library, the better it will be. I tried compiling OpenCV 2.1 and 2.2 a couple of times with no luck on various machines (the eee included... that took about an hour and a half). However I was delighted to find that someone that someone had compiled 2.1 for Ubuntu 10.04 and 10.10. All that was needed to be done to install it was:</p>
<pre>
$ sudo add-apt-repository ppa:gijzelaar/OpenCV2
$ sudo apt-get update
$ sudo apt-get install OpenCV python-OpenCV
</pre>

<p>and OpenCV is yours for the taking! Install the documentation and run the examples to figure out if all your V4L2 and webcam drivers will play nice with it.</p>
<h2 id="classifiers-are-easily-fooled">Classifiers are easily fooled</h2>
<p><img src="http://i.imgur.com/XPuhpl.jpg" alt="image"></p>
<p>This is pretty self explanatory. I drew the above face with a purple magic marker in about five seconds and it is able to fool the Haar classifier.</p>
<p>Additionally, I have found that the wrong lighting, glasses, and long hair can throw it off as well. To be fair, Haar feature detection in this case is not incredibly accurate. The advantage it possesses in this application is relatively low computational complexity which translates into a speedy detection algorithm.</p>
<h2 id="cpu-speed">CPU speed</h2>
<p>As I said in the video, performance on the eee PC was terrible. While not surprising, this is kind of upsetting as I was considering putting it to use as the brains of the robot once I add some sort of locomotion to the system. I was pleasantly surprised however when I loaded up the code on to my new laptop (which has a Core 2 duo operating at 1.3GHz) and things worked beautifully. It would seem that OpenCV, even though I thought that python couldn&#39;t be threaded, is somehow threading itself across both cores of the processor. As I&#39;m still new to python and all of these technology, so sit tight! I&#39;m still learning how all this stuff works. </p>


    </div>
  

    <div id="post-content-2011-02-03-execute-time-and-plot-c-programs-with-python">
      <center>
<img src="assets/img/posts/Fig.png" class="thumbnail" width="80%">
</center>

<p>Hate excel? Have python take all the pain away from you! This should appeal to everyone out there who needs a quick way to analyze the runtime time of a bunch of commands to a program given an arbitrary list of arguments. Hating excel/openoffice/spreadsheets in general is optional.</p>
<p>Just like every programmer, I am always trying to find new and interesting ways of automating myself out of a job. To that end, I wrote a pretty cool program last night to help automate my first algorithms lab.</p>
<p>Consistent with the recent trend of mine, it is in python and makes use of the <a href="http://docs.python.org/library/subprocess.html">subprocess</a> module to spawn and time instances of my C++ program and <a href="http://matplotlib.sourceforge.net/">pylab</a> to make plotting the times super easy. The comments in my code explain things in more detail, but here is the one sentence summary: Python is being used to execute two programs written in C++ with the same set of arguments and spits out a plot of their times. In this case the two C++ programs are recursive (rfib) and iterative (ifib) implementations of the Fibonacci algorithm. The fun stuff is in the python:</p>
<pre>
#!/usr/bin/env python

# Lucas Doyle wrote this

import subprocess
import string
import sys
import pylab  # matplotlib

def timerun(program, args) :
    print 'Starting timed execution of ' + program + ' with ' + str(len(args)) + ' arguments.'
    i = 1

    # Execute program, once for each n argument
    for n in args :

        # This was really annoying. Build the arguments to the time system call to the time command.
        # First of all, for whatever reason 'time' didn't work correctly with any arguments other than -p, 
        # so I used /usr/bin/time instead. Since I could not figure out why the output of 'time' was not
        # coming back to stdin, I use the -o (output file) and -a (append) option to just output the real
        # execution time ( thats where '-f' and '%e' comes from ) to the file.
        p = subprocess.Popen(['/usr/bin/time', '-o', 'runtimes.txt', '-a', '-f', '%e', './' + program, str(n)], stdout=subprocess.PIPE)

        # Read back from stdin, print where we are (not required, but its nice)
        output = p.communicate()[0]
        sys.stdout.write( str(i) + ':\tfib('+ str(n) + ') = ' + output)
        i += 1
    print 'done'

    # Open up, read and return the times in the output file
    f = open('runtimes.txt', 'r')
    times = f.read().splitlines()

    # Clean up old runtimes
    subprocess.Popen(['rm', 'runtimes.txt'],stdout=subprocess.PIPE)

    return times

def main():

    # Arguments we are interested in testing runtimes for
    # args = 1, 5, 10, 15, 20, 25, 30, 35, 40, 41, 42, 43, 44, 45, 46, 47, 48
    args = range(1, 56)



    # Compute the runtimes of the recursive algorithm, then the iterative one
    rtimes = timerun('rfib', args)
    itimes = timerun('ifib', args)

    # Plot it with pylab
    pylab.xlabel('N')
    pylab.ylabel('Time to compute fib(N) (seconds)')
    pylab.title('Recursive vs. Iterative Execution Time for Fibionacci Sequence')
    pylab.plot(args, rtimes, 'ro-', label='Recursive')
    pylab.plot(args, itimes, 'bo-', label='Iterative')
    pylab.legend()

    # other drawing styles for plots in pylab:
    # 'r' red line, 'g' green line, 'y' yellow line 
    # 'ro' red dots as markers, 'r.' smaller red dots, 'r+' red pluses
    # 'r--' red dashed line, 'g^' green triangles, 'bs' blue squares
    # 'rp' red pentagons, 'r1', 'r2', 'r3', 'r4' well, check out the markers

    # save the plot as a PNG image
    pylab.savefig('Fig.png')

    # show the pylab plot window
    pylab.show()

if __name__ == "__main__":
    main()

</pre>

<p>I&#39;ve also attached the whole lab <a href="misc/lab1.zip">here</a> in case the python does not make sense by itself. Hope someone finds this useful!</p>



    </div>
  

    <div id="post-content-2011-01-26-rudimentary-gmailbased-print-server">
      <p>Another example of python being super useful. I found myself today with a need to network a printer so my room mates and I could print from anywhere on campus. However, figuring out what ports to forward, trying to get IPP to work and just being generally unhappy with CUPS and the way RPIs network restricts printer traffic / discovery lead me to consider alternate solutions.</p>
<p>Enter python and Gmail! I wanted to be able to have someone email me a message with a few keywords in the subject line that would tag any attachments for printing. I then had python log into my email and download the most recent email for printing, and if the attachment was new to it, print it. I wrote a nice little script that does just that:</p>
<p><a href="https://github.com/Stonelinks/gmail-printsrv">Here it is on github</a></p>
<p>All you gotta do is edit the username and password at the top of the script, and set up a cron job to call the script on the machine with the printer attached.</p>
<p>A couple of other comments about this: It is dangerous! Someone could email you a file with a malformed name and escape out of the print command that gets called by the subprocess. Not good. There are probably other security risks (like the fact that your password is stored in plaintext). Thats it! have fun kids!</p>



    </div>
  

    <div id="post-content-2011-01-07-a-more-accurate-coordinate-system">
      <center>
<iframe width="550" height="450" src="http://www.youtube.com/embed/c72tK4KTTj0" frameborder="0" allowfullscreen></iframe>
</center>
<br>

<p>RPI health and safety inspections did not take kindly to my <a href="door-mounted-roboschwarzenegger.html">door mounted Robo-Schwarzenegger</a>. Apparently I&#39;m not breaking any rules with an internet controlled webcam hanging from my door, but the power cord across the doorway is a tripping hazard. I took Arnold down and brought him home with me over the break with the goal of teaching myself some python and jumping into OpenCV.</p>
<p>I played with both OpenCV and Python a few years ago when I more or less <a href="http://blog.jozilla.net/2008/06/27/fun-with-python-opencv-and-face-detection/">followed this tutorial</a>, but ultimately could not get decent control of the camera. I figured the first step in doing this the right way was to get better control over the camera. Below I&#39;ll describe how I accomplished this.</p>
<h3 id="the-arduino">The Arduino</h3>
<p>The old way I had of doing things on the Arduino was very simplistic and took no advantage of any Arduino libraries. Essentially the protocol between the computer and the arduino was a single character corresponding to a single action. Like many modern PC games, movement of the camera was set up in standard WASD fashion (&quot;W&quot; moved the Y axis up, &quot;S&quot; moved it down, &quot;A&quot; moved the X axis left, etc). Using PWM this was straightforward to code: an if-else block that would do things like &quot;if W comes down the serial line, increment the current Y pulse width by 10&quot;. At the end of the if-else block, if it was time to make a pulse the program would bring the pins connected to the servo high, wait for the pulse width, then bring it back low. There was also a hard coded center, and limits set up so the servos did not go past their limits. All in all, very simple, but it got the job done. The new way of doing things is a little more complicated, but is much more useful in terms of precision. It takes inspiration from this <a href="http://principialabs.com/arduino-python-4-axis-servo-control/">wonderful tutorial</a> to take advantages of the Arduino servo libraries and simplify things. First, a three part protocol between the PC and Arduino is established:</p>
<ol>
<li>The PC sends a &#39;255&#39; to the Arduino to let it know that we want to move servos. This is good for future expansion because we can use 0-254 to do other things with the micro-controller. For example, send something like &#39;254&#39; to move speed controllers or get a reading from a GPS. 255 is essentially the servo &quot;channel&quot;.</li>
<li>The PC sends a number corresponding to the index of a servo on the Arduino it wants to move. In my setup, 1 means the X axis and 2-means the Y axis.</li>
<li>Last, an angle between 0 and 180 is sent telling the Arduino where to move the servo.</li>
</ol>
<p>When implementing this protocol,  in that list is used to pick a servo object to apply the <a href="http://arduino.cc/en/Reference/ServoWrite">write()</a> function that takes the angle in number three as its argument. The Arduino does the rest! There is a catch though -- in order for the Arduino to properly instantiate a servo object, you need to use the attach() function. Since there are minimum and maximum pulse widths (hardware limits) we care about so the pan tilt module doesn&#39;t rip itself apart, those minimum and maximum pulse widths need to be known. I actually used the old version of my code and a couple print statements to write a diagnostic program I could use to figure out the pulse width limits. I have that attached as well as the real code.</p>
<h2 id="the-python">The Python</h2>
<hr>
<p>Now not to diss PHP or anything (which is what I have most of my experience with at this point), but python just seems like a more grown up language. There is a lot to like about it. Every time I read or hear about something cool being done, it is almost always involves python! So far with the tutorials out there it has been awesome. The python segments here are short and not very advanced. I wrote one important function - move(). It takes an angle and a servo as arguments and -- you guessed it -- moves the specified servo to their specified angle. One problem though -- due to me being an imperfect craftsman and not mounting the servos perfectly straight, the angular position of (90, 90) does not make the camera point straight ahead as one would expect. Therefore I wrote another simple diagnostic function to allow the interactive centering of the servos. Once I had the middle for the X and Y axis, I could use this in the move function to shift the centers.</p>
<p>Once move() was done, I wrote some test code and it worked like a champ! I then started stacking calls to move() inside of loops and I wrote some code to make the camera move in simple rectangles. Some problems then became clear: the pan tilt module either moves too slow, too fast or just spazzes out if you issue enough commands to it. Increasing the baud rate helped to speed things up, however it would still freak out if you told it to move really fast. I determined that there needs to be some delay between move() calls. Once again, I wrote some diagnostic code to determine this. The pan tilt module would move in rectangles with increasingly longer pauses between move() calls. At some critical delay value, the pan tilt module stopped jittering and moved smoothly (but still pretty fast) around the perimeter of the rectangle (turned out to be 0.003 seconds). As a final example of what the system can do, I wrote the spiral code that appears in the video above. It is only a few lines of python, but I spaced them out and commented them for ease of understanding:</p>
<pre>
def spiral():
    a = .01;  # "stretch" factor for sin and cosine
    t = 0;    # time value

    # time loop that stops when the stretch factor is 1
    while (a < 1) :

        # increase the time step
        t+=1

        # if 50 time steps have gone by, increment a
        if (t % 50 == 0) : a+=.01

        # move the servos to middle, plus or minus some scaled
        # value of sin or cosine. Change 'a' to something fixed
        # between 0 and 1 and the spiral is now a circle
        servo.move(1, 90 + a * math.degrees(math.cos(math.radians(t))))
        servo.move(2, 90 + a * math.degrees(math.sin(math.radians(t))))

        # delay between the move calls
        time.sleep(.0045)
</pre>

<h2 id="conclusion-attachments">Conclusion &amp; Attachments</h2>
<hr>
<p>So that was it! Now I have unrestricted access to use python to do (almost) whatever I want! Looking at the python bindings for OpenCV next!</p>
<ul>
<li><a href="http://dl.dropbox.com/u/4428042/stonelinks_public/main.cpp">Arduino main code</a></li>
<li><a href="http://dl.dropbox.com/u/4428042/stonelinks_public/servolimits.cpp">Arduino servo pulsewidth diagnostic code</a></li>
<li><a href="http://dl.dropbox.com/u/4428042/stonelinks_public/main.py">Python main code</a></li>
<li><a href="http://dl.dropbox.com/u/4428042/stonelinks_public/servo.py">Python servo module</a></li>
</ul>


    </div>
  

    <div id="post-content-2010-12-22-electromagnets-how-do-they-work">
      <center>
<img src="assets/img/posts/downsize1-225x300.jpg" class="thumbnail" width="50%">
</center>

<p>Home for the break! My brother asked me for help making a small electromagnet to bring into Boy Scouts for electricity merit badge. I of course jumped at the opportunity, and asked what kind of power source they are going to be using to drive said magnet. He tells me they will be using a single D battery. Thinking this is kind of small, I spent a few hours making the biggest electromagnet I could from a few things around the house I could find.</p>
<p>I ultimately settled on sawing an old golf club in half, stuffing a large bolt down the hollow inside, and then mounting the whole thing in a drill to facilitate easy winding of some low-gauge wire I found in our garage. To top it off, I powered the whole thing with an old computer power supply (5V at 25A I believe). The whole affair vaguely looks like some kind of torture device. The end result is a large electro magnet that can pick up very heavy weights and gets furiously hot and smells like burning plastic if left on for more than 5 minutes. Totally overkill for Boy Scouts, but totally awesome.</p>
<p>Mission: Success.</p>



    </div>
  

    <div id="post-content-2010-12-21-stonelinks-hosted-at-my-house">
      <p>Looks like the kinks of my new <a href="dr-serverlove-or-how-i-learned-to-stop-worrying-and-love-the-raid.html">two-server</a> setup are not ironed out. I just got home from RPI and the old Dell is acting wacky at school. I thoroughly checked both machines before I left for home, and I thought everything was okay. However, upon arriving home, I checked the web server to find that it doesn&#39;t work -- not even a 404 page or a time out error, the browser just hangs.</p>
<p>To use anything other than HTTP on port 80, I need to be on RIP&#39;s VPN. I log into the VPN and start with the basics. The machine (which is not behind a NAT router) responds to ping, however ssh shows the same symptoms as apache and the conenction just hangs. I don&#39;t even get a connection refused, path not found or timeout error.</p>
<p>After being thoroughly baffled by this, I ran NMAP from another machine on the same network:</p>
<pre><code class="language-bash">[luke@void ~]$ nmap -A -T4 stonelinks.org
Starting Nmap <span class="number">4.11</span> ( http://www.insecure.org/nmap/ ) at <span class="number">2010</span>-<span class="number">12</span>-<span class="number">27</span> <span class="number">03</span>:<span class="number">39</span> EST
Interesting ports on doylel2.stu.rpi.edu (<span class="number">128.113</span>.<span class="number">38.125</span>):
Not shown: <span class="number">1676</span> closed ports
PORT    STATE SERVICE  VERSION
<span class="number">21</span>/tcp  open  ftp?
<span class="number">22</span>/tcp  open  ssh?
<span class="number">80</span>/tcp  open  http?
<span class="number">111</span>/tcp open  rpcbind?</code></pre>
<p>I have VPN access and control over other computers on the same network, but obviously no physical access to the machine. I have no idea what is going on here. My assumption is that the kernel is hanging on something? But I guess I&#39;ll find out when I get back. Because of the way RPI manages IP addresses, the firewall at RPI, and the uncertainty of the other computer, I&#39;m hesitant to just tell my desktop to take the old MAC / IP combo for Stonelinks until I get back on campus in case I lose both machines. Luckily I had a backup of Stonelinks that I moved to my house. Until I get back on campus, I am hosting off my houses internet connection! Be warned in this time Stonelinks will be operating in a pretty crippled capacity.</p>



    </div>
  

    <div id="post-content-2010-12-07-dr-serverlove-or-how-i-learned-to-stop-worrying-and-love-the-raid">
      <center>
<img src="assets/img/posts/downsize-300x225.jpg" class="thumbnail" width="50%">
<br>
These two suckers now live on my desk and throw off a ton of heat.
</center>

<p>I recently completed some much needed upgrades to the servers (hardware and software) that run Stonelinks. This has me very excited and has been a long time in the works! Warning: long and somewhat pointless story of blood, sweat, nerdrage and glorious payoff ahead.</p>
<p>Despite being a humongous Linux nerd, for years I have hosted Stonelinks using Windows / <a href="http://www.wampserver.com/en/">WAMP</a> server (which is the same thing as LAMP, just replace Linux with Windows). For a long time this was my only option as far as &quot;free&quot; hosting using RPI&#39;s bandwidth, as my desktop is the only computer I own that is consistently on 24/7 and can function in a server role.</p>
<p>By necessity, my desktop needs to be running Windows 7 because unfortunately I need access to a bunch of programs that I can&#39;t get or don&#39;t exist for Linux. Things like LabVIEW for work at the <a href="work/work-at-harvard--smithsonian.html">Harvard-Smithsonain Center for Astrophysics</a>, MATLAB so my room mate can run his week long computational fluid dynamic simulations on for his research (we need our own supercomputer for this!), Solidworks for random CAD I occasionally do, Netflix because content licensing people are afraid of Linux and finally Team Fortress 2 because I occasionally like to get my game on. Because of the sporadic nature of when I use most of these programs, it also means that dual booting between Linux and Windows is of the question since that doesn&#39;t guarentee uptime. I didn&#39;t want to shut down the server while someone was using it just so I could boot into Windows and do some CAD.</p>
<p>Therefore, I have stuck with my WAMP setup for many years. As far as WAMP is concerned, it has sort of been &quot;fine&quot; most of the time, but definitely not ideal. All of the other websites I work on are hosted from some flavor of Linux. It is free, extremely stable, makes administration and development a breeze compared to Windows (what a nightmare it was to get PHP&#39;s mail() command to work with SSL in Windows), the list goes on. </p>
<p>Hosting Stonelinks under Linux has been a goal/dream of mine for awhile now. Occasionally I would try using a virtual machine to host, but I&#39;d always find that to be too resource intensive and would BSOD windows after awhile if left on for too long. Cygwin was and always has been a nightmare for me too, so I didn&#39;t even go there. Interestingly, I did have some success with something called <a href="http://www.andlinux.org/">andLinux</a> which, by my understanding, is an Ubuntu installation based around a Linux kernel compiled to use win32 system calls a la <a href="http://www.colinux.org/">coLinux</a>. All the benefits of a virtual machine without the instability and losing a massive chunk of RAM. I ultimately dumped andLinux, mostly because andLinux uses a virtual network adapter to communicate with Windows. A webserver running under andLinux would be heavily bandwidth constrained for any clients other than localhost. So up until writing this I&#39;ve been really, throughly stuck.</p>
<p>Fast forward to a few weeks before Christmas. For an early Christmas present, I decided to replace my Dad&#39;s aging Dell with a Newegg special custom desktop. I built him a pretty sweet machine, and even got him using Ubuntu (quite the tech-savvy 63 year old!), with a Windows XP virtual machine to fall back on if he ever gets really stuck with something. This left his old desktop vacated for me to use!</p>
<p>The Dell made it&#39;s glorious pilgrimage to RPI with me where I proceeded to wipe it&#39;s brains and installed the latest Ubuntu on it. I then began the task of porting Stonelinks over to that machine. One problem though: my Dad&#39;s old Dell did not have enough disk space for it. Queue my second Newegg purchase: I bought two 2-TB SATA disks and a RAID card (among other things) on cyber Monday for the crazy price of $180 (granted the RAID card is not a &quot;real&quot; RAID card, as none of the parity checking for RAID is done by hardware on the card it is basically a glorified SATA controller). I wrongfully assumed that since the RAID card was PCI, it would be compatible with the old Dell. I thought that since there were no SATA ports on the motherboard of the Dell I could use the RAID card to be the root of the webserver. At the very worst, I knew the firmware on the card was swappable so I could re-flash firmware on the card to make it act as a pass through (no RAID whatsoever) for the drives to the OS. Booooy was I wrong.</p>
<p>First of all, the RAID controller was not being picked up, not even in the BIOS, on the Dell. No matter what I tried, it wouldn&#39;t work in the Dell (and yes I had the Linux drivers for it / proper kernel modules running). I thought I might have a defective card so I tried it in a spare PCI slot on my desktop. The card worked like a charm! At this point I was tearing my hair out -- Something on the Dell&#39;s motherboard was incompatable with the RAID card? I didn&#39;t even care about RAID at this point, I just wanted SATA drives to work on the Dell at which point I could use something like <a href="http://en.wikipedia.org/wiki/Mdadm">mdadm</a> for fake RAID. I thought that flashing the firmware that makes the card act like a pass through was a good idea. This opened up a new can of nightmares for me!</p>
<p>Turns out that Silicon Image (SI from here on out), the maker of the &quot;fake&quot; RAID controller chip on the card I bought, supplies its chips / firmware to 3rd parties that put together the cards and sell them. In order to even begin messing with the firmware on the card I had to use a bunch of really bad DOS executables that I called from the command line, and then had to echo the return value (took me forever to figure out how to do... damn windows shell) so I could match the number up with the response code on some PDF off their website and figure out what was wrong. At this point I am furious that I&#39;ve wasted so much time on this. Using the sinfully awful SI tools, I eventually figured out that my card manufacturer, Rosewill, was storing the device firmware on an external flash chip that I could not flash with any different firmware.</p>
<p>At this point I have not slept in probably 24 hours and am feeling like I want to skewer the card on my African war sword (yes I own one of these) throw it in the oven, set it to self clean and walk away. Alas, I am too stubborn to give up like that though, so I cook up a phenomena (and what will be my final) solution to hosting this iteration of Stonelinks.</p>
<p>Essentially, I separated content between the two servers by keeping the RAID array on my main desktop, sharing it as a Windows share, and then using <a href="https://help.ubuntu.com/community/Autofs">autofs</a> to mount the share on the Dell and serve it. Both machines live behind the same 10/100 switch and I can pull data off there at fairly high speeds, so I was happy! The hardest part about getting this to work was managing permissions between the two machines and finding a good way to keep track of my Desktop because its IP was no longer static. I accomplished the former by being a clever chmod user, and the latter with dynamic DNS. Overall, I&#39;d say the lessons I learned from this were things I already knew but were or sure reinforced:</p>
<ul>
<li>Don&#39;t buy something (RAID card in this case) just because it is cheap.</li>
<li>Don&#39;t make assumptions about how something will work, do your research.</li>
<li>Instead of trying solve a complicated problem all at once and banging your head against the wall, walk away from it. When you come back and attack it bit by bit, you&#39;re more likely to have more energy and better insight.</li>
</ul>


    </div>
  

    <div id="post-content-2010-11-25-documentation-is-done">
      <p>Suzanne has told me to stop working on the current iteration of the documentation as I had been writing it for an audience unacquainted with my work, not for her and my coworker. I have provided her with what she needs, but it would be a shame for all the writing I did not to see the light of day. Maybe it will be useful to someone. After all, it was written for an unacquainted audience, so you might learn something! <a href="misc/CfA_doc.pdf">Here it is</a></p>



    </div>
  

    <div id="post-content-2010-11-22-labview-custom-documentation-formats">
      <p>LabVIEW is a necessary and constant evil with my work at the Harvard-Smithsonian Center for Astrophysics, but sometimes it pulls through. Earlier today I found myself with a need to extract a whole bunch of icons, block diagrams and VI hierarchies a bunch of LabVIEW programs. I had begun that onerous task that many programmers like to sip: documentation. In my case, I was using LaTeX and wanted to include visuals from my LabVIEW stuff.</p>
<p>Up until now I thought this would mean trying to do a million screenshots over VNC on my work computer, and then going back and cropping what I needed. This seemed horrible though and on further research I was thrilled to find out that LabVIEW can pretty much do this on its own. See the <a href="http://zone.ni.com/reference/en-XX/help/371361B-01/lvconcepts/printing_vis/">NI website on printing VI documentation</a>.</p>
<p>Basically what I did was import the VI hierarchy for my top level VI (the lab dashboard in my case), create a custom format for my documentation, check off what I want to appear, and then output it all as HTML. The end result looks <a href="luke/work/cfa/example/">something like this</a>. Since the directory where the HTML was generated is now chock full o&#39; images, I just took what ones I wanted and inserted them into my documentation and discarded the HTML. Just goes to show you how a user can find many different ways to use a one part of a program for what it might not have originally been intended. Probably a couple hours of tedious screenshotting saved! And I can re-run the process any time if things change.</p>



    </div>
  

    <div id="post-content-2010-11-22-latex-is-fun">
      <p>I&#39;m using the documentation I&#39;m writing for work at the Harvard-Smithsonain Center for Astrophysics as an excuse to learn LaTeX. For those in my generation who have grown up with MS Office or openoffice.org, LaTeX is a typesetting language that can trace its roots back to the legendary <a href="http://en.wikipedia.org/wiki/Donald_Knuth">Donald Knuth</a> who wrote TeX back in the &#39;70s.</p>
<p>Long story short, it is awesome and really straightforward if you&#39;re a programmer. Honestly the thing that upsets me the most about LaTeX is that I didn&#39;t know it existed back when Matt and I were writing / editing that <a href="misc/IED_tech_report_final.pdf">137 page paper</a> for the IED border patrol robot!</p>

    </div>
  

    <div id="post-content-2010-11-12-door-mounted-roboschwarzenegger">
      <center>
<img src="assets/img/posts/downsize_4-225x300.jpg" class="thumbnail" width="50%">
</center>
<br>

<p>I don&#39;t get to fool around with my own projects nearly as much as I would like, but this weekend I did devote a few hours to finishing up a robotic internet controlled camera on our apartment door.</p>
<p>The pre-existing peep hole on our door didn&#39;t exactly work, and I&#39;m tired of people knocking and having no idea who is there, so I felt like this was an appropriate solution. The story of exactly how and why I made this goes back to this summer.</p>
<p>One day in August I had this idea of creating a Generic Web Enabled Robotic Operating System (GWEROS... yeah I know it&#39;s a pretty stupid sounding name, give me a break) that would essentially allow you to create an awesome, high functioning robot out of a wide variety of off the shelf hardware and popular web technologies so long as it had a few basic requirements: a webserver, a webcam, a serial port attached to a microcontroller (arduino, pic, whatever) and some servos, motors, wheels or whatever. The aspiring robot enthusiast would cobble together whatever hardware he or she can manage, install GWEROS (make the install/update process really simple like <a href="http://codex.wordpress.org/Installing_WordPress">wordpress</a>) and be up and running in no time.</p>
<p>Basically I thought it could be like a less hardcore version of <a href="http://www.ros.org/wiki/">ROS</a> (which is totally badass) for use exclusively in the browser. I even think if done properly and given enough time to gather community support, people much smarter than myself could write plugins that would allow GWEROS users to do powerful things with their robots <a href="http://mjpg-streamer.svn.sourceforge.net/viewvc/mjpg-streamer/mjpg-streamer/www/javascript_motiondetection.html?revision=83&amp;view=markup&amp;pathrev=83">right from their web browser</a> typically reserved high end or high priced robots.</p>
<p>Needless to say it was an extremely ambitious for a project for the middle of a busy summer internship. While I wish I had the time to pour into making it a reality, I had more than enough on my plate at the Harvard-Smithsonain Center for Astrophysics. Therefore I only started writing the interface and just finished writing some basic camera / telemetry code this weekend. The end result is what you see here:</p>



<center>

<img class="thumbnail" width="50%" src="assets/img/posts/downsize_2-150x150.jpg">
<img class="thumbnail" width="50%" src="assets/img/posts/downsize-150x150.jpg">
<img class="thumbnail" width="50%" src="assets/img/posts/downsize_3-150x150.jpg">
<img class="thumbnail" width="50%" src="assets/img/posts/Screenshot-150x150.png">

</center>

<p>The best part about it? Nobody even knows it&#39;s there because it is disguised as Arnold Schwarzenegger.</p>


    </div>
  

    <div id="post-content-2010-09-30-windows-based-webcam-control-software">
      <p>I love nothing more in life than creating and tinkering with the stuff around me. Over the years, this love has taken many different forms. It started out somewhere in elementary school with Legos and taking my toys apart (much to the chigrin of my loving parents). Today it has evolved over the years into weekend projects such as the I&#39;m about to tell you about.</p>
<p>One weekend early in the semester, I found myself with some rare free time and so I chose to make my own internet-aware pan-tilt fixture for my webcam. To my room mates <a href="http://en.wikipedia.org/wiki/Sarcasm">delight</a>, I have placed the controls to this camera on this website.</p>
<p>Projects such as this are just the kind of thing that I love taking time to do. They span the full stack, and involve concepts that go from very low level micro controller programming to high level web programming, using all sorts of code and hardware as inbetween. It requirees quite a lot of different skill sets and knowledge of systems integration for this to work. Anyhow enough self-aggrandizing, I&#39;ll describe how I did it starting very low level at the and working my way up.</p>
<h3 id="hardware">Hardware</h3>
<p><a href="assets/img/posts/2010-02-08-193359.jpg"><img src="assets/img/posts/2010-02-08-193359-150x150.jpg" alt="image" title="2010-02-08-193359"></a></p>
<p>This summer I came into possession of an <a href="http://www.arduino.cc/">Arduino</a> micro controller and <a href="http://www.rcuniverse.com/product_guide/servoprofile.cfm?servo_id=67">some servos</a>. As you can see from the pictures, I connected the servos up to the micro controller, making Y-cables for the power, ground, and signal pins of the servos. I also added a laser diode for good measure.</p>
<p>The servo signal pins were wired to the digital I/O ports on the arduino. I stuffed the Arduino in a metal box I had lying around and hot glued everything together. Predictably, the webcam itself didn&#39;t require much work. It was actually given to me for free! (previous owner couldn&#39;t find drivers for it). I just ripped the stand off of it and glued it to the servos. All in all, this was a cheap and simple that has performed very well for what it was designed to do.</p>
<hr>
<h3 id="microcontroller-code">Microcontroller Code</h3>
<p>I wrote the following code to establish basic control of the Arduino over its USB serial adapter. The servos are controlled using a technique called pulse width modulation (PWM). The comments explain what is going on, but for further background reading you can check out <a href="http://en.wikipedia.org/wiki/Pulse-width_modulation">this</a>. It also uses EEPROM to store the position of the camera between power cycles and resets. For some background about what EEPROM is check out <a href="http://en.wikipedia.org/wiki/EEPROM">this</a>.</p>
<pre><code class="language-c">/*
 * File:            pantilt.c
 * Description:     A program for controlling
 *                  servos for use on a pan / tilt
 *                  module on my robot
 * Author:          Lucas Doyle (lucas.p.doyle@gmail.com)
 * Creation Date:   October 16, 2009
 * Revision Date:   Jan 31, 2010
 */

// Since the Arduino resets itself every time a serial connection is
// made in windows (if you&#39;re writing characters from PHP or something),
// I have chosen to use the Arduinos EEPROM to store the positions
// between resets. Therefore we include the EEPROM header.
#include EEPROM

// variables dealing with the pins
char servoPinX    =  2;    // control pin for the first servo
char servoPinY    =  3;    // control pin for the second
char laserpin     = 13;    // the camera has a little laser diode on it

// PWM variables
int minPulseX    = 600;  // minimum servo position
int maxPulseX    = 2400; // maximum servo position
int minPulseY    = 500;   // same thing for other servo
int maxPulseY    = 1850;
char turnRate    = 100;  // servo turn rate increment (larger value, faster rate)
char refreshTim  = 20;   // time (ms) between pulses (50Hz)

// The Arduino will calculate these values
int centerServoX;         // center servo position
int centerServoY;
int pulseWidthX;          // servo pulse width
int pulseWidthY;
char moveServo;            // raw user input

long lastPulse   = 0;     // recorded time (ms) of the last pulse

// mode variables
int laseron      = 0;     // start out with the laser off by default

// party mode, some stupid idea i had to have the camera
// spaz out and strobe the laser, has not been written yet
// because i have not had time
int partymode    = 0;

// This function writes an int to eeprom at p_address
// Adapted from Marc Cardinals work:
// http://blog.ncode.ca/wp-content/uploads/2008/08/eeprom-int-readwrite.pde
void EEPROMWriteInt(int p_address, int p_value)
{
  byte lowByte = ((p_value &gt;&gt; 0) &amp; 0xFF);
  byte highByte = ((p_value &gt;&gt; 8) &amp; 0xFF);

  EEPROM.write(p_address, lowByte);
  EEPROM.write(p_address + 1, highByte);
}

// This function reads the int back
// Also adapted from Marc Cardinals work:
// http://blog.ncode.ca/wp-content/uploads/2008/08/eeprom-int-readwrite.pde
unsigned int EEPROMReadInt(int p_address)
{
  byte lowByte = EEPROM.read(p_address);
  byte highByte = EEPROM.read(p_address + 1);
  return ((lowByte &lt;&lt; 0) &amp; 0xFF) + ((highByte &lt;&lt; 8) &amp; 0xFF00); }


void setup()
{
  // Set up servo and laser pins as an output  
  pinMode(servoPinX, OUTPUT);  
  pinMode(laserpin, OUTPUT);
  pinMode(servoPinY, OUTPUT);  

  // calculate center positions for both servos  
  centerServoX = maxPulseX - ((maxPulseX - minPulseX)/2);  
  centerServoY = maxPulseY - (((maxPulseY - minPulseY)/2)-280);  

  // If you&#39;re running this for the first time on your arduino,  
  // uncomment the next two lines to initialize the EEPROM
  // EEPROMWriteInt(0, centerServoX);  
  // EEPROMWriteInt(2, centerServoY);  

  pulseWidthX = EEPROMReadInt(0);  
  pulseWidthY = EEPROMReadInt(2);  

  // begin serial communication  
  Serial.begin(9600);  

  //Serial.println(&quot;Arduino Serial Pan/tilt Control&quot;);
  //Serial.println(&quot;Standard WASD to move, spacebar to center&quot;);
  //Serial.println(&quot;L toggles the laser, TFGH goes to the extremes&quot;);
}

void loop()
{  
  // wait for serial input
  if (Serial.available() &gt; 0)
  {
    // read the incoming byte:
    moveServo = Serial.read();

    // if party mode is off, read in commands
    //if (partymode == 0)
    {
      //if (moveServo == (char) &quot; &quot;) {/*nothing happens*/}

      // move left
      if (moveServo == &#39;a&#39;) { pulseWidthX = pulseWidthX - turnRate; }

      // move right
      else if (moveServo == &#39;d&#39;) { pulseWidthX = pulseWidthX + turnRate; }

      // move up
      else if (moveServo == &#39;w&#39;) { pulseWidthY = pulseWidthY - turnRate; }

      // move down
      else if (moveServo == &#39;s&#39;) { pulseWidthY = pulseWidthY + turnRate; }

      // center
      else if (moveServo == &#39;c&#39;) { pulseWidthX = centerServoX; pulseWidthY = centerServoY;}

      // move hard left
      else if (moveServo == &#39;f&#39;) {pulseWidthX = minPulseX; }

      // move hard right
      else if (moveServo == &#39;h&#39;) {pulseWidthX = maxPulseX; }

      // move hard up
      else if (moveServo == &#39;t&#39;) {pulseWidthY = minPulseY; }

      // move hard down
      else if (moveServo == &#39;g&#39;) {pulseWidthY = maxPulseY; }

      // toggle the laser
      else if (moveServo == &#39;l&#39;)
      {
        if (laseron == 0) { digitalWrite(laserpin, HIGH); laseron = 1; }
        else if (laseron == 1) { digitalWrite(laserpin, LOW); laseron = 0; }
      }
    }

    // however if party mode is enabled
    //else if (partymode == 1)
    //{
      // do some awesome stuff (not yet implemented)
    //  Serial.print(&quot;Party!!! &quot;);
    //}

    // party mode
    //else if (moveServo == &#39;p&#39;)
    //{
    //  if (partymode == 0) { partymode = 1; }
    //  else if (partymode == 1) { partymode = 0; }
    //}
  }

  // stop servo pulse at min and max
  if (pulseWidthX &gt; maxPulseX) { pulseWidthX = maxPulseX; }
  if (pulseWidthX &lt; minPulseX) { pulseWidthX = minPulseX; }
  if (pulseWidthY &gt; maxPulseY) { pulseWidthY = maxPulseY; }
  if (pulseWidthY &lt; minPulseY) { pulseWidthY = minPulseY; }

  // print pulseWidth back to the Serial Monitor (uncomment to debug)
  // Serial.print(&quot;Pulse Width: &quot;);
  // Serial.print(pulseWidth);
  // Serial.println(&quot;us&quot;);   // microseconds

  // pulse the servo every 20 ms (refreshTime) with current pulseWidth
  // this will hold the servo&#39;s position if unchanged, or move it if changed
  if (millis() - lastPulse &gt;= refreshTime)
  {
    EEPROMWriteInt(0, pulseWidthX);
    EEPROMWriteInt(2, pulseWidthY);

    digitalWrite(servoPinX, HIGH);   // start the pulse
    delayMicroseconds(pulseWidthX);  // pulse width
    digitalWrite(servoPinX, LOW);    // end the pulse

    digitalWrite(servoPinY, HIGH);   // start the pulse for servo 2
    delayMicroseconds(pulseWidthY);  // pulse width
    digitalWrite(servoPinY, LOW);    // stop the pulse

    lastPulse = millis();            // save the time of the last pulse
  }
}</code></pre>
<h3 id="establishing-serial-communication">Establishing Serial Communication</h3>
<p>If you load the above code into the Arduino&#39;s IDE and flash it to your microcontroller, you end up with a nice, intuitive way of manually controlling your pan / tilt mechanism. You can try things out by opening the Serial Monitor in the Arduino IDE and moving around using WASD, or move to the extremes using TFGH. Pressing &#39;C&#39; centers the camera back and &#39;L&#39; <a href="http://spf.fotolog.com/photo/47/10/95/vanguardista2104/1211331863_f.jpg">fires the laser</a>. Arguably, you could stop here and technically still have a way of controlling the camera over the internet with the power of linux. All one would need to do is open up a terminal or ssh into the machine and run the following command:</p>
<pre><code class="language-bash"> ~$ screen /dev/ttyUSB0</code></pre>
<p>This was not good enough for me though, as I wanted to control this through a web browser, which brings us to...</p>
<h3 id="the-web-server">The Web Server</h3>
<p><a href="assets/img/posts/2010-02-08-193241.jpg"><img src="assets/img/posts/2010-02-08-193241-150x150.jpg" alt="image" title="2010-02-08-193241"></a></p>
<p>The Arduino is cool and all, but since the ultimate goal of this project is to control it over the internet, having a web server is an obvious requirement. Unfortunately for me, my web server also happens to be my self-built desktop that I use for almost all my other engineering work and day to day activities. Because of this, I need access to few windows only applications (Solidworks, LabVIEW, Photoshop, Steam, etc..) which rules out any linux server platforms if I want 100% uptime. This is an unfortunate contstraint that caused me quite a lot of headaches down the line. In the future when I have another computer to spare and improve on this project, I will use the <a href="http://blog.taragana.com/wp-content/uploads/2008/03/linux-logo.jpg">right tool</a> for the job. </p>
<p>After all that rambling, you&#39;re probably wondering how I have my web server configured. The only relevant details are that I am running stock <a href="http://www.wampserver.com/en/">WampServer</a> with PHP 5.3.0 with short tags enabled.</p>
<h3 id="nightmare-in-php-land">Nightmare in PHP land</h3>
<p>I thought this would be easy. Since PHP is a server side scripting language, it has libraries that allow it to read and write to and from serial ports. So one would think that something like the following would work:</p>
<pre><code class="language-php"><span class="variable">$fp</span> =fopen(<span class="string">"COM3"</span>, <span class="string">"w"</span>);
fwrite(<span class="variable">$fp</span>, chr(<span class="string">'c'</span>)); <span class="comment">// write your character to the Arduino here</span>
sleep(<span class="number">1</span>);
fclose(<span class="variable">$fp</span>);</code></pre>
<p>However, for reasons I do not completely understand, this did not work for me under Windows 7, but it did with Linux (substituting COM3 for /dev/ttyUSB0). This problem persisted, as I also tried using the <a href="http://www.phpclasses.org/browse/package/3679.html">PHP serial class</a>, but it too proved to be equally as ineffective. I finally circumvented the need for PHP to communicate with the COM port entirely by compiling several very basic exe&#39;s in <a href="http://processing.org/">processing</a> that sent individual character commands to the Arduino and then called them in PHP using the exec() function.</p>
<p>While extremely inefficient, this was the quickest, most reliable solution to my problem. Of course, this would all have been avoided in the first place had I been using Linux, as PHP has no problem writing to /dev/ttyUSB0 like it would a normal file in Linux.</p>
<h3 id="building-the-webpage">Building the Webpage</h3>
<p>By accessing the <a href="http://www.w3schools.com/PHP/php_get.asp">PHP $_GET</a> array, I was able to map incoming GET requests to different URLS to control what commands were sent to the camera. The PHP included in the header of the page is shown here:</p>
<pre><code class="language-php"><span class="comment">// check the GET action var to see if an action is to be performed</span>
<span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">'action'</span>]))
{
   <span class="comment">// action required! build our command...</span>
   <span class="variable">$basecmd</span> = <span class="string">"F:\\wamp\\www\\luke\\Projects\\personal_robot\\personal robot\\commands\\"</span>;
   <span class="variable">$cmd</span> = <span class="variable">$basecmd</span> . <span class="variable">$_GET</span>[<span class="string">'action'</span>] . <span class="string">"\\application.windows\\"</span> . <span class="variable">$_GET</span>[<span class="string">'action'</span>] . <span class="string">".exe"</span>;
   exec(<span class="variable">$cmd</span>);
}</code></pre>
<p>And the HTML for the rest of the page is simply a 3x3 table with some hyperlinks to the right URLs with things like ?action=up, ?action=down, ect. placed in the right spot.</p>
<h3 id="webcam">Webcam</h3>
<p>To manage the webcam feed, I am using a program called <a href="http://www.lundie.ca/fwink/">Fwink</a> to take a picture every second and then using AJAX to automatically refresh the image once the page is loaded. However, there are many ways to manage a webcam feed and the details of how you do it is out of the scope of what I&#39;m talking about here.</p>
<h2 id="conclusions-and-future-improvements">Conclusions and Future Improvements</h2>
<p>As expected, performance with this setup is less than impressive, but this was more a learning excersize than it was a perfect execution. I have no doubts in my mind that the low performance is due to the wonky way in which I have to execute system calls to run the Processing exes. For the future, as this is a rough prototype, a lot can be improved / simplified by moving to Linux.</p>
<p>Additionally, this is the vision component to my yet-to-be-completed personal robot, and its brains (a first generation ASUS eeepc netbook) are currently on loan to a friend of mine. Next time I see him I&#39;ll get the machine back and we&#39;ll start cooking with gas! (and by gas I mean Linux).</p>



    </div>
  

    <div id="post-content-2014-06-07-looking-back">
      This is old. Look at posts if you want to see current versions of my projects. This was like the first thing of great significance I did with Stonelinks on my own (read: I didn't know what I was doing). Similar to the Windows based webcam thing, I thought it was a big deal at the time. Looking back it is funny how trivial this would be to implement nowadays. Oh also, there are things in here that are just plain wrong and/or bad practice (left as an exercise to the reader to find).




**Edit:** This is old. It is also the first implementation of my remote-controlled camera... under windows. It is really really bad and nobody should use it. However, I thougt I was pretty cool when I made it, and maybe it will be useful to somebody here, so I'll leave it up. I put a much more improved version this software to use on [the border patrol robot](misc/IED_tech_report_final.pdf). Check out page 48 of the report to see the final results and the page 118 for the code behind it.

    </div>
  
</div>

<script id="post-template" type="text/template" class="template">
  <div class="row post">
  <div class="box">
    <div class="col-lg-12">
      <hr>
      <a id="<%= id %>" href="/posts/<%= id %>.html">
      <h1 class="intro-text text-center">
      <%= title %>
      <br/>
      <small><%= date %></small>
      </h1></a>
      <hr>
      <%= $content.html() %>
    </div>
  </div>
</div>

</script>



</div>



<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-12 text-center">
              
                <a class="social" href="https://www.facebook.com/stonelinks" target="_blank">
                  <i class="fa fa-facebook"></i>
                </a>
              
                <a class="social" href="https://github.com/Stonelinks" target="_blank">
                  <i class="fa fa-github"></i>
                </a>
              
                <a class="social" href="https://twitter.com/#!/Stonelinks" target="_blank">
                  <i class="fa fa-twitter"></i>
                </a>
              
                <a class="social" href="https://plus.google.com/116178490514652721625/posts" target="_blank">
                  <i class="fa fa-google-plus"></i>
                </a>
              
                <a class="social" href="http://www.linkedin.com/pub/lucas-doyle/25/550/169" target="_blank">
                  <i class="fa fa-linkedin"></i>
                </a>
              
                <a class="social" href="http://www.youtube.com/user/RealStonelinks" target="_blank">
                  <i class="fa fa-youtube"></i>
                </a>
              
              <a class="footer-link" href="">
                contact
              </a>
            </div>
        </div>
    </div>
</footer>



  </body>
</html>
