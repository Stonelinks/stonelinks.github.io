<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Execute, Time and Plot C++ Programs with Python - Stonelinks
    </title>
    <link rel="icon" href="/images/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="/style/main.css">
  </head>
  <body>
    <div class="chrome-wrapper">
      <div class="chrome-wrapper-inner">
        <div class="chrome-container">
          <div class="masthead clearfix"><a href="/">
              <div class="masthead-logo"><img src="/images/logos/logo-200.png"></div>
              <h1 class="masthead-brand">Stonelinks
              </h1></a>
            <p class="masthead-tagline">Lucas Doyle's Website
            </p>
            <nav>
              <ul class="nav masthead-nav">
                <li><a href="/blog.html">Blog</a></li>
                <li><a href="/luke.html">About</a></li>
                <li><a href="/projects.html">Projects</a></li>
              </ul>
            </nav>
          </div>
          <div id="preloaded-images"></div>
          <div class="container">
            <div class="box-row">
              <div class="row">
                <div class="box">
                  <div class="col-lg-12"><a href="/posts/execute-time-and-plot-c-programs-with-python.html">
                      <h1 class="box-title">Execute, Time and Plot C++ Programs with Python</h1></a>
                    <div class="byline">
                      <p>Published in<a href="/tag/algorithms/1/"><span class="label label-primary tag">algorithms</span></a><a href="/tag/python/1/"><span class="label label-primary tag">python</span></a>
                      </p>
                      <p>February 03, 2011 by&nbsp;<a href="/luke.html">Lucas Doyle</a>
                      </p>
                    </div>
                    <div class="external-links"><div class="media-container"><br><br><img src="/images/posts/Fig.png"><br><br></div>

<p>Hate excel? Have python take all the pain away from you! This should appeal to everyone out there who needs a quick way to analyze the runtime time of a bunch of commands to a program given an arbitrary list of arguments. Hating excel/openoffice/spreadsheets in general is&nbsp;optional.</p>
<p>Just like every programmer, I am always trying to find new and interesting ways of automating myself out of a job. To that end, I wrote a pretty cool program last night to help automate my first algorithms&nbsp;lab.</p>
<p><span class="more"></span></p>
<p>Consistent with the recent trend of mine, it is in python and makes use of the <a href="http://docs.python.org/library/subprocess.html">subprocess</a> module to spawn and time instances of my C++ program and <a href="http://matplotlib.sourceforge.net/">pylab</a> to make plotting the times super easy. The comments in my code explain things in more detail, but here is the one sentence summary: Python is being used to execute two programs written in C++ with the same set of arguments and spits out a plot of their times. In this case the two C++ programs are recursive (rfib) and iterative (ifib) implementations of the Fibonacci algorithm. The fun stuff is in the&nbsp;python:</p>
<pre><code class="lang-python"><span class="comment">#!/usr/bin/env python</span>

<span class="comment"># Lucas Doyle wrote this</span>

<span class="keyword">import</span> subprocess
<span class="keyword">import</span> string
<span class="keyword">import</span> sys
<span class="keyword">import</span> pylab  <span class="comment"># matplotlib</span>

<span class="function"><span class="keyword">def</span> <span class="title">timerun</span><span class="params">(program, args)</span> :</span>
    <span class="keyword">print</span> <span class="string">'Starting timed execution of '</span> + program + <span class="string">' with '</span> + str(len(args)) + <span class="string">' arguments.'</span>
    i = <span class="number">1</span>

    <span class="comment"># Execute program, once for each n argument</span>
    <span class="keyword">for</span> n <span class="keyword">in</span> args :

        <span class="comment"># This was really annoying. Build the arguments to the time system call to the time command.</span>
        <span class="comment"># First of all, for whatever reason 'time' didn't work correctly with any arguments other than -p, </span>
        <span class="comment"># so I used /usr/bin/time instead. Since I could not figure out why the output of 'time' was not</span>
        <span class="comment"># coming back to stdin, I use the -o (output file) and -a (append) option to just output the real</span>
        <span class="comment"># execution time ( thats where '-f' and '%e' comes from ) to the file.</span>
        p = subprocess.Popen([<span class="string">'/usr/bin/time'</span>, <span class="string">'-o'</span>, <span class="string">'runtimes.txt'</span>, <span class="string">'-a'</span>, <span class="string">'-f'</span>, <span class="string">'%e'</span>, <span class="string">'./'</span> + program, str(n)], stdout=subprocess.<span class="caps">PIPE</span>)

        <span class="comment"># Read back from stdin, print where we are (not required, but its nice)</span>
        output = p.communicate()[<span class="number">0</span>]
        sys.stdout.write( str(i) + <span class="string">':\tfib('</span>+ str(n) + <span class="string">') = '</span> + output)
        i += <span class="number">1</span>
    <span class="keyword">print</span> <span class="string">'done'</span>

    <span class="comment"># Open up, read and return the times in the output file</span>
    f = open(<span class="string">'runtimes.txt'</span>, <span class="string">'r'</span>)
    times = f.read().splitlines()

    <span class="comment"># Clean up old runtimes</span>
    subprocess.Popen([<span class="string">'rm'</span>, <span class="string">'runtimes.txt'</span>],stdout=subprocess.<span class="caps">PIPE</span>)

    <span class="keyword">return</span> times

<span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span>

    <span class="comment"># Arguments we are interested in testing runtimes for</span>
    <span class="comment"># args = 1, 5, 10, 15, 20, 25, 30, 35, 40, 41, 42, 43, 44, 45, 46, 47, 48</span>
    args = range(<span class="number">1</span>, <span class="number">56</span>)



    <span class="comment"># Compute the runtimes of the recursive algorithm, then the iterative one</span>
    rtimes = timerun(<span class="string">'rfib'</span>, args)
    itimes = timerun(<span class="string">'ifib'</span>, args)

    <span class="comment"># Plot it with pylab</span>
    pylab.xlabel(<span class="string">'N'</span>)
    pylab.ylabel(<span class="string">'Time to compute fib(N) (seconds)'</span>)
    pylab.title(<span class="string">'Recursive vs. Iterative Execution Time for Fibionacci Sequence'</span>)
    pylab.plot(args, rtimes, <span class="string">'ro-'</span>, label=<span class="string">'Recursive'</span>)
    pylab.plot(args, itimes, <span class="string">'bo-'</span>, label=<span class="string">'Iterative'</span>)
    pylab.legend()

    <span class="comment"># other drawing styles for plots in pylab:</span>
    <span class="comment"># 'r' red line, 'g' green line, 'y' yellow line </span>
    <span class="comment"># 'ro' red dots as markers, 'r.' smaller red dots, 'r+' red pluses</span>
    <span class="comment"># 'r--' red dashed line, 'g^' green triangles, 'bs' blue squares</span>
    <span class="comment"># 'rp' red pentagons, 'r1', 'r2', 'r3', 'r4' well, check out the markers</span>

    <span class="comment"># save the plot as a <span class="caps">PNG</span> image</span>
    pylab.savefig(<span class="string">'Fig.png'</span>)

    <span class="comment"># show the pylab plot window</span>
    pylab.show()

<span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:
    main()
</code></pre>
<p>I’ve also attached the whole lab <a href="/misc/lab1.zip">here</a> in case the python does not make sense by itself. Hope someone finds this&nbsp;useful!</p>
</div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="box">
                  <div class="col-lg-12 footer-nav"><a href="/blog.html">
                      <h4 class="pull-left">« Back</h4></a></div>
                </div>
              </div>
            </div>
          </div>
          <div class="mastfoot"><a href="https://www.facebook.com/stonelinks" target="_blank" class="social"><i class="fa fa-facebook"></i></a><a href="https://github.com/Stonelinks" target="_blank" class="social"><i class="fa fa-github"></i></a><a href="https://twitter.com/#!/Stonelinks" target="_blank" class="social"><i class="fa fa-twitter"></i></a><a href="https://plus.google.com/116178490514652721625/posts" target="_blank" class="social"><i class="fa fa-google-plus"></i></a><a href="http://www.linkedin.com/pub/lucas-doyle/25/550/169" target="_blank" class="social"><i class="fa fa-linkedin"></i></a><a href="http://www.youtube.com/user/RealStonelinks" target="_blank" class="social"><i class="fa fa-youtube"></i></a><a href="mailto:lucas.p.doyle@gmail.com?Subject=Hello" target="_top">Contact me</a>
          </div>
        </div>
      </div>
    </div>
    <script src="/node_modules/jquery/dist/jquery.js"></script>
    <script src="/node_modules/underscore/underscore.js"></script>
    <script src="/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script type="text/javascript">
      var BASENAME = 'posts/execute-time-and-plot-c-programs-with-python';
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-18750328-2', 'auto');
      ga('send', 'pageview');
    </script>
    <script src="/js/main.js"></script>
  </body>
</html>