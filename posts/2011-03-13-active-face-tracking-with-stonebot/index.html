<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/icon.png" fetchPriority="high"/><link rel="stylesheet" href="/_next/static/css/0c1cbe041aef36e6.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/7a6e15ce7603e944.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-06eb45215460ab53.js"/><script src="/_next/static/chunks/fd9d1056-be48aeae6e94b8d1.js" async=""></script><script src="/_next/static/chunks/23-093443f120d56e9e.js" async=""></script><script src="/_next/static/chunks/main-app-f67fffbe34eb65ac.js" async=""></script><script src="/_next/static/chunks/994-e0384b19511b091b.js" async=""></script><script src="/_next/static/chunks/app/posts/%5Bslug%5D/page-c6567c6c1ae134f3.js" async=""></script><meta name="theme-color" content="#ffffff"/><title>Face Tracking with Stonebot - Lucas Doyle - Personal Website | Stonelinks</title><meta name="description" content="Read this post by Lucas Doyle"/><meta property="og:title" content="Face Tracking with Stonebot"/><meta property="og:description" content="Read this post by Lucas Doyle"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Face Tracking with Stonebot"/><meta name="twitter:description" content="Read this post by Lucas Doyle"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body><div class="flex flex-col items-center min-h-screen p-6 pt-0 "><div class="flex flex-col items-center mt-6 mb-2 md:mb-8 md:flex-row md:items-center md:justify-start"><div class="mb-4 md:mb-0 md:mr-4 flex justify-center"><img alt="Logo" fetchPriority="high" width="100" height="100" decoding="async" data-nimg="1" style="color:transparent" src="/icon.png"/></div><div class="flex flex-col items-center md:items-start"><h1 class="text-4xl md:text-6xl font-serif mb-2">Stonelinks</h1><ul class="flex list-none gap-4"><li><a href="/">Home</a></li><li><a href="/posts/">Posts</a></li><li><a href="/projects/">Projects</a></li><li><a href="/luke/">About</a></li></ul></div></div><div class="max-w-3xl"><article class="p-5"><h1>Face Tracking with Stonebot</h1><p class="text-sm text-gray-500 mt-0 mb-4">March 13, 2011</p><div class="flex flex-wrap gap-2 mb-6"><a class="bg-gray-200 hover:bg-gray-300 text-gray-700 text-sm font-medium rounded px-2.5 py-0.5" href="/tags/robots/">robots</a><a class="bg-gray-200 hover:bg-gray-300 text-gray-700 text-sm font-medium rounded px-2.5 py-0.5" href="/tags/computer%20vision/">computer vision</a><a class="bg-gray-200 hover:bg-gray-300 text-gray-700 text-sm font-medium rounded px-2.5 py-0.5" href="/tags/python/">python</a></div><div class="prose max-w-none mt-4"><p>I finally have it working! Very excited as I write this. So glad spring break exists otherwise I'd never have the time for this. Long story short, I have face detection working on my personal robot. Check out the video after to see it in action.</p>
<iframe src="//www.youtube.com/embed/RRwMJ8GYT7Y" frameborder="0" allowfullscreen></iframe>
<p>This has been a goal of mine ever since I started building my personal robot (which, in keeping with the Stonelinks legacy, shall henceforth be known as "Stonebot"). This face tracking makes use of my <a href="/posts/2011-01-06-a-more-accurate-coordinate-system/">new method for positioning the camera</a> that I worked on a little over winter break, and is probably the most complicated piece of python I have written to date. Here are some highlights of the project:</p>
<h3>OpenCV</h3>
<p>By far, the hardest thing about this was getting OpenCV set up correctly. Once set up, it is relatively easy to use, comes with a lot of cool examples and seems extremely powerful (if you don't believe me check out what the folks over at <a href="http://www.willowgarage.com/">Willow Garage</a> do with it on a routine basis). In the future it is definitely something I want to experiment more with, and not just use for face and object detection.</p>
<p>A summary of the build process: If you're like me and running Ubuntu 10.04, you'll want to save some time from having to compile OpenCV from source (especially if you are on a 900MHz single core eee pc like I originally was). Unfortunately, the most recent version of OpenCV is 2.2 while the latest version in the official Ubuntu repos it is only 2.0. Normally I wouldn't care about using an older version, however when I looked at the python examples for 2.2, 2.1 and 2.0, things looked much cleaner in 2.2 and 2.1 (you can import everything under the single namespace using <code>import cv</code> in 2.1 on up for example).</p>
<p>Additionally, . I tried compiling OpenCV 2.1 and 2.2 a couple of times with no luck on various machines (the eee included... that took about an hour and a half). However I was delighted to find that someone that someone had compiled 2.1 for Ubuntu 10.04 and 10.10 on a ppa. All that was needed to be done to install it was:</p>
<pre><code class="hljs language-bash">$ <span class="hljs-built_in">sudo</span> add-apt-repository ppa:gijzelaar/OpenCV2
$ <span class="hljs-built_in">sudo</span> apt-get update
$ <span class="hljs-built_in">sudo</span> apt-get install OpenCV python-OpenCV
</code></pre>
<p>and OpenCV is yours for the taking! Install the documentation and run the examples to figure out if all your V4L2 and webcam drivers will play nice with it.</p>
<h3>Classifiers are easily fooled</h3>
<img src="http://i.imgur.com/XPuhpl.jpg">
<p>This is pretty self explanatory. I drew the above face with a magic marker and it was able to fool OpenCV's Haar face classifier.</p>
<p>Additionally, I have found that the wrong lighting, glasses, and long hair can throw it off as well. To be fair, Haar feature detection in this case is not incredibly accurate. The advantage it possesses in this application is relatively low computational complexity which translates into a speedy detection algorithm.</p>
<h3>CPU speed</h3>
<p>As I said in the video, performance on the eee PC was terrible. While not surprising, this is kind of upsetting as I was considering putting it to use as the brains of the robot once I add some sort of locomotion to the system. I was pleasantly surprised however when I loaded up the code on to my new laptop (which has a Core 2 duo operating at 1.3GHz) and things worked beautifully. It would seem that OpenCV, even though I thought that python couldn't be threaded, is somehow threading itself across both cores of the processor. I'm still very new to python and this whole technology stack, so sit tight! I'm still learning how all it all works.</p></div></article><footer><hr class="py-4"/>Â© <a href="/luke/">Lucas Doyle</a> <!-- -->2025</footer></div></div><script src="/_next/static/chunks/webpack-06eb45215460ab53.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/0c1cbe041aef36e6.css\",\"style\"]\n2:HL[\"/_next/static/css/7a6e15ce7603e944.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"3:I[5751,[],\"\"]\n6:I[9275,[],\"\"]\n8:I[1343,[],\"\"]\n9:I[8173,[\"994\",\"static/chunks/994-e0384b19511b091b.js\",\"333\",\"static/chunks/app/posts/%5Bslug%5D/page-c6567c6c1ae134f3.js\"],\"Image\"]\na:I[231,[\"994\",\"static/chunks/994-e0384b19511b091b.js\",\"333\",\"static/chunks/app/posts/%5Bslug%5D/page-c6567c6c1ae134f3.js\"],\"\"]\nc:I[6130,[],\"\"]\n7:[\"slug\",\"2011-03-13-active-face-tracking-with-stonebot\",\"d\"]\nd:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/0c1cbe041aef36e6.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"rIbg1UnKYfj0oUqMH-l6m\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/2011-03-13-active-face-tracking-with-stonebot/\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"2011-03-13-active-face-tracking-with-stonebot\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"2011-03-13-active-face-tracking-with-stonebot\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"2011-03-13-active-face-tracking-with-stonebot\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L4\",\"$L5\"],null],null]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",\"$7\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/7a6e15ce7603e944.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]]}],null]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"children\":[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center min-h-screen p-6 pt-0 \",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center mt-6 mb-2 md:mb-8 md:flex-row md:items-center md:justify-start\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-4 md:mb-0 md:mr-4 flex justify-center\",\"children\":[\"$\",\"$L9\",null,{\"src\":\"/icon.png\",\"alt\":\"Logo\",\"width\":100,\"height\":100,\"priority\":true}]}],[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center md:items-start\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-4xl md:text-6xl font-serif mb-2\",\"children\":\"Stonelinks\"}],[\"$\",\"ul\",null,{\"className\":\"flex list-none gap-4\",\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"$La\",null,{\"href\":\"/\",\"children\":\"Home\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$La\",null,{\"href\":\"/posts\",\"children\":\"Posts\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$La\",null,{\"href\":\"/projects\",\"children\":\"Projects\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$La\",null,{\"href\":\"/luke\",\"children\":\"About\"}]}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"max-w-3xl\",\"children\":[[[\"$\",\"h1\",null,{\"className\":\"mb-2\",\"children\":\"404 - Page Not Found\"}],[\"$\",\"p\",null,{\"className\":\"mb-4 text-gray-600\",\"children\":\"Sorry, that page does not exist.\"}]],[\"$\",\"footer\",null,{\"children\":[[\"$\",\"hr\",null,{\"className\":\"py-4\"}],\"Â© \",[\"$\",\"$La\",null,{\"href\":\"/luke\",\"children\":\"Lucas Doyle\"}],\" \",2025]}]]}]]}],\"notFoundStyles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/7a6e15ce7603e944.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],\"styles\":null}]}]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$Lb\"],\"globalErrorComponent\":\"$c\",\"missingSlots\":\"$Wd\"}]]\n"])</script><script>self.__next_f.push([1,"e:Tf45,"])</script><script>self.__next_f.push([1,"\u003cp\u003eI finally have it working! Very excited as I write this. So glad spring break exists otherwise I'd never have the time for this. Long story short, I have face detection working on my personal robot. Check out the video after to see it in action.\u003c/p\u003e\n\u003ciframe src=\"//www.youtube.com/embed/RRwMJ8GYT7Y\" frameborder=\"0\" allowfullscreen\u003e\u003c/iframe\u003e\n\u003cp\u003eThis has been a goal of mine ever since I started building my personal robot (which, in keeping with the Stonelinks legacy, shall henceforth be known as \"Stonebot\"). This face tracking makes use of my \u003ca href=\"/posts/2011-01-06-a-more-accurate-coordinate-system/\"\u003enew method for positioning the camera\u003c/a\u003e that I worked on a little over winter break, and is probably the most complicated piece of python I have written to date. Here are some highlights of the project:\u003c/p\u003e\n\u003ch3\u003eOpenCV\u003c/h3\u003e\n\u003cp\u003eBy far, the hardest thing about this was getting OpenCV set up correctly. Once set up, it is relatively easy to use, comes with a lot of cool examples and seems extremely powerful (if you don't believe me check out what the folks over at \u003ca href=\"http://www.willowgarage.com/\"\u003eWillow Garage\u003c/a\u003e do with it on a routine basis). In the future it is definitely something I want to experiment more with, and not just use for face and object detection.\u003c/p\u003e\n\u003cp\u003eA summary of the build process: If you're like me and running Ubuntu 10.04, you'll want to save some time from having to compile OpenCV from source (especially if you are on a 900MHz single core eee pc like I originally was). Unfortunately, the most recent version of OpenCV is 2.2 while the latest version in the official Ubuntu repos it is only 2.0. Normally I wouldn't care about using an older version, however when I looked at the python examples for 2.2, 2.1 and 2.0, things looked much cleaner in 2.2 and 2.1 (you can import everything under the single namespace using \u003ccode\u003eimport cv\u003c/code\u003e in 2.1 on up for example).\u003c/p\u003e\n\u003cp\u003eAdditionally, . I tried compiling OpenCV 2.1 and 2.2 a couple of times with no luck on various machines (the eee included... that took about an hour and a half). However I was delighted to find that someone that someone had compiled 2.1 for Ubuntu 10.04 and 10.10 on a ppa. All that was needed to be done to install it was:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003e$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e add-apt-repository ppa:gijzelaar/OpenCV2\n$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e apt-get update\n$ \u003cspan class=\"hljs-built_in\"\u003esudo\u003c/span\u003e apt-get install OpenCV python-OpenCV\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eand OpenCV is yours for the taking! Install the documentation and run the examples to figure out if all your V4L2 and webcam drivers will play nice with it.\u003c/p\u003e\n\u003ch3\u003eClassifiers are easily fooled\u003c/h3\u003e\n\u003cimg src=\"http://i.imgur.com/XPuhpl.jpg\"\u003e\n\u003cp\u003eThis is pretty self explanatory. I drew the above face with a magic marker and it was able to fool OpenCV's Haar face classifier.\u003c/p\u003e\n\u003cp\u003eAdditionally, I have found that the wrong lighting, glasses, and long hair can throw it off as well. To be fair, Haar feature detection in this case is not incredibly accurate. The advantage it possesses in this application is relatively low computational complexity which translates into a speedy detection algorithm.\u003c/p\u003e\n\u003ch3\u003eCPU speed\u003c/h3\u003e\n\u003cp\u003eAs I said in the video, performance on the eee PC was terrible. While not surprising, this is kind of upsetting as I was considering putting it to use as the brains of the robot once I add some sort of locomotion to the system. I was pleasantly surprised however when I loaded up the code on to my new laptop (which has a Core 2 duo operating at 1.3GHz) and things worked beautifully. It would seem that OpenCV, even though I thought that python couldn't be threaded, is somehow threading itself across both cores of the processor. I'm still very new to python and this whole technology stack, so sit tight! I'm still learning how all it all works.\u003c/p\u003e"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center min-h-screen p-6 pt-0 \",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center mt-6 mb-2 md:mb-8 md:flex-row md:items-center md:justify-start\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-4 md:mb-0 md:mr-4 flex justify-center\",\"children\":[\"$\",\"$L9\",null,{\"src\":\"/icon.png\",\"alt\":\"Logo\",\"width\":100,\"height\":100,\"priority\":true}]}],[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center md:items-start\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-4xl md:text-6xl font-serif mb-2\",\"children\":\"Stonelinks\"}],[\"$\",\"ul\",null,{\"className\":\"flex list-none gap-4\",\"children\":[[\"$\",\"li\",null,{\"children\":[\"$\",\"$La\",null,{\"href\":\"/\",\"children\":\"Home\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$La\",null,{\"href\":\"/posts\",\"children\":\"Posts\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$La\",null,{\"href\":\"/projects\",\"children\":\"Projects\"}]}],[\"$\",\"li\",null,{\"children\":[\"$\",\"$La\",null,{\"href\":\"/luke\",\"children\":\"About\"}]}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"max-w-3xl\",\"children\":[[\"$\",\"article\",null,{\"className\":\"p-5\",\"children\":[[\"$\",\"h1\",null,{\"children\":\"Face Tracking with Stonebot\"}],[\"$\",\"p\",null,{\"className\":\"text-sm text-gray-500 mt-0 mb-4\",\"children\":\"March 13, 2011\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap gap-2 mb-6\",\"children\":[[\"$\",\"$La\",\"0\",{\"className\":\"bg-gray-200 hover:bg-gray-300 text-gray-700 text-sm font-medium rounded px-2.5 py-0.5\",\"href\":\"/tags/robots\",\"children\":\"robots\"}],[\"$\",\"$La\",\"1\",{\"className\":\"bg-gray-200 hover:bg-gray-300 text-gray-700 text-sm font-medium rounded px-2.5 py-0.5\",\"href\":\"/tags/computer%20vision\",\"children\":\"computer vision\"}],[\"$\",\"$La\",\"2\",{\"className\":\"bg-gray-200 hover:bg-gray-300 text-gray-700 text-sm font-medium rounded px-2.5 py-0.5\",\"href\":\"/tags/python\",\"children\":\"python\"}]]}],\"$undefined\",\"$undefined\",[\"$\",\"div\",null,{\"className\":\"prose max-w-none mt-4\",\"dangerouslySetInnerHTML\":{\"__html\":\"$e\"}}]]}],[\"$\",\"footer\",null,{\"children\":[[\"$\",\"hr\",null,{\"className\":\"py-4\"}],\"Â© \",[\"$\",\"$La\",null,{\"href\":\"/luke\",\"children\":\"Lucas Doyle\"}],\" \",2025]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"name\":\"theme-color\",\"content\":\"#ffffff\"}],[\"$\",\"meta\",\"2\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"3\",{\"children\":\"Face Tracking with Stonebot - Lucas Doyle - Personal Website | Stonelinks\"}],[\"$\",\"meta\",\"4\",{\"name\":\"description\",\"content\":\"Read this post by Lucas Doyle\"}],[\"$\",\"meta\",\"5\",{\"property\":\"og:title\",\"content\":\"Face Tracking with Stonebot\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:description\",\"content\":\"Read this post by Lucas Doyle\"}],[\"$\",\"meta\",\"7\",{\"name\":\"twitter:card\",\"content\":\"summary\"}],[\"$\",\"meta\",\"8\",{\"name\":\"twitter:title\",\"content\":\"Face Tracking with Stonebot\"}],[\"$\",\"meta\",\"9\",{\"name\":\"twitter:description\",\"content\":\"Read this post by Lucas Doyle\"}],[\"$\",\"link\",\"10\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]]\n4:null\n"])</script></body></html>