<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.60cae20257538861a9e1.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-fc117160c69a8ea0851b26dd14748ee4.woff2) format("woff2"),url(/static/merriweather-latin-300-58b18067ebbd21fda77b67e73c241d3b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-fe29961474f8dbf77c0aa7b9a629e4bc.woff2) format("woff2"),url(/static/merriweather-latin-300italic-23c3f1f88683618a4fb8d265d33d383a.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-d9479e8023bef9cbd9bf8d6eabd6bf36.woff2) format("woff2"),url(/static/merriweather-latin-400-040426f99ff6e00b86506452e0d1f10b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-2de7bfeaf08fb03d4315d49947f062f7.woff2) format("woff2"),url(/static/merriweather-latin-400italic-79db67aca65f5285964ab332bd65f451.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-4b08e01d805fa35d7bf777f1b24314ae.woff2) format("woff2"),url(/static/merriweather-latin-700-22fb8afba4ab1f093b6ef9e28a9b6e92.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-cd92541b177652fffb6e3b952f1c33f1.woff2) format("woff2"),url(/static/merriweather-latin-700italic-f87f3d87cea0dd0979bfc8ac9ea90243.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-f813fc6a4bee46eda5224ac7ebf1b7be.woff2) format("woff2"),url(/static/merriweather-latin-900-5d4e42cb44410674acd99153d57df032.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-b7901d85486871c1779c0e93ddd85656.woff2) format("woff2"),url(/static/merriweather-latin-900italic-9647f9fdab98756989a8a5550eb205c3.woff) format("woff")}


/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{-webkit-text-size-adjust:100%;line-height:1.15}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden],template{display:none}:root{--maxWidth-none:"none";--maxWidth-xs:20rem;--maxWidth-sm:24rem;--maxWidth-md:28rem;--maxWidth-lg:32rem;--maxWidth-xl:36rem;--maxWidth-2xl:42rem;--maxWidth-3xl:48rem;--maxWidth-4xl:56rem;--maxWidth-full:"100%";--maxWidth-wrapper:var(--maxWidth-2xl);--spacing-px:"1px";--spacing-0:0;--spacing-1:0.25rem;--spacing-2:0.5rem;--spacing-3:0.75rem;--spacing-4:1rem;--spacing-5:1.25rem;--spacing-6:1.5rem;--spacing-8:2rem;--spacing-10:2.5rem;--spacing-12:3rem;--spacing-16:4rem;--spacing-20:5rem;--spacing-24:6rem;--spacing-32:8rem;--fontFamily-sans:Montserrat,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--fontFamily-serif:"Merriweather","Georgia",Cambria,"Times New Roman",Times,serif;--font-body:var(--fontFamily-serif);--font-heading:var(--fontFamily-sans);--fontWeight-normal:400;--fontWeight-medium:500;--fontWeight-semibold:600;--fontWeight-bold:700;--fontWeight-extrabold:800;--fontWeight-black:900;--fontSize-root:16px;--lineHeight-none:1;--lineHeight-tight:1.1;--lineHeight-normal:1.5;--lineHeight-relaxed:1.625;--fontSize-0:0.833rem;--fontSize-1:1rem;--fontSize-2:1.2rem;--fontSize-3:1.44rem;--fontSize-4:1.728rem;--fontSize-5:2.074rem;--fontSize-6:2.488rem;--fontSize-7:2.986rem;--color-primary:#005b99;--color-text:#2e353f;--color-text-light:#4f5969;--color-heading:#1a202c;--color-heading-black:#000;--color-accent:#d1dce5}*,:after,:before{box-sizing:border-box}html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-size:var(--fontSize-root);line-height:var(--lineHeight-normal)}body{color:var(--color-text);font-family:var(--font-body);font-size:var(--fontSize-1)}footer{padding:var(--spacing-6) var(--spacing-0)}hr{background:var(--color-accent);border:0;height:1px}h1,h2,h3,h4,h5,h6{font-family:var(--font-heading);letter-spacing:-.025em;line-height:var(--lineHeight-tight);margin-bottom:var(--spacing-6);margin-top:var(--spacing-12)}h2,h3,h4,h5,h6{color:var(--color-heading);font-weight:var(--fontWeight-bold)}h1{color:var(--color-heading-black);font-size:var(--fontSize-6);font-weight:var(--fontWeight-black)}h2{font-size:var(--fontSize-5)}h3{font-size:var(--fontSize-4)}h4{font-size:var(--fontSize-3)}h5{font-size:var(--fontSize-2)}h6{font-size:var(--fontSize-1)}h1>a,h2>a,h3>a,h4>a,h5>a,h6>a{color:inherit;text-decoration:none}p{--baseline-multiplier:0.179;--x-height-multiplier:0.35;line-height:var(--lineHeight-relaxed);margin:var(--spacing-0) var(--spacing-0) var(--spacing-8) var(--spacing-0)}ol,p,ul{padding:var(--spacing-0)}ol,ul{list-style-image:none;list-style-position:outside;margin-bottom:var(--spacing-8);margin-left:var(--spacing-0);margin-right:var(--spacing-0)}ol li,ul li{padding-left:var(--spacing-0)}li>p,ol li,ul li{margin-bottom:calc(var(--spacing-8)/2)}li :last-child{margin-bottom:var(--spacing-0)}li>ul{margin-left:var(--spacing-8);margin-top:calc(var(--spacing-8)/2)}blockquote{border-left:var(--spacing-1) solid var(--color-primary);color:var(--color-text-light);font-size:var(--fontSize-2);font-style:italic;margin-bottom:var(--spacing-8);margin-left:calc(var(--spacing-6)*-1);margin-right:var(--spacing-8);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-6)}blockquote>:last-child{margin-bottom:var(--spacing-0)}blockquote>ol,blockquote>ul{list-style-position:inside}table{border-collapse:collapse;border-spacing:.25rem;margin-bottom:var(--spacing-8);width:100%}table thead tr th{border-bottom:1px solid var(--color-accent)}a{color:var(--color-primary)}a:focus,a:hover{text-decoration:none}.global-wrapper{margin:var(--spacing-0) auto;max-width:var(--maxWidth-wrapper);padding:var(--spacing-10) var(--spacing-5)}.global-header{margin-bottom:var(--spacing-12)}.main-heading{font-size:var(--fontSize-7);margin:0}.post-list-item{margin-bottom:var(--spacing-8);margin-top:var(--spacing-8)}.post-list-item p{margin-bottom:var(--spacing-0)}.post-list-item h2{color:var(--color-primary);font-size:var(--fontSize-4);margin-bottom:var(--spacing-2);margin-top:var(--spacing-0)}.post-list-item header{margin-bottom:var(--spacing-4)}.header-link-home{font-family:var(--font-heading);font-size:var(--fontSize-2);font-weight:var(--fontWeight-bold);text-decoration:none}.header-img{float:left;margin-right:var(--spacing-4);min-width:80px}.header-link-nav{font-family:var(--font-heading);font-size:var(--fontSize-1);font-weight:var(--fontWeight-bold)}.bio{border-bottom:1px solid var(--color-heading);margin-bottom:var(--spacing-4);padding-bottom:var(--spacing-8)}.bio-avatar{border-radius:100%;float:left;margin-right:var(--spacing-4);min-width:50px}.blog-post header h1{margin:var(--spacing-0) var(--spacing-0) var(--spacing-4) var(--spacing-0)}.blog-post header p{font-family:var(--font-heading);font-size:var(--fontSize-2)}.blog-post-nav ul{margin:var(--spacing-0)}.gatsby-highlight{margin-bottom:var(--spacing-8)}@media (max-width:42rem){blockquote{margin-left:var(--spacing-0);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-4)}ol,ul{list-style-position:inside}}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 4.2.0"/><style data-styled="" data-styled-version="5.3.3"></style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">Windows Based Webcam Control Software | Stonelinks</title><meta data-react-helmet="true" name="description" content="I love nothing more in life than creating and tinkering with the stuff around me. Over the years, this love has taken many different forms. It started out…"/><meta data-react-helmet="true" property="og:title" content="Windows Based Webcam Control Software"/><meta data-react-helmet="true" property="og:description" content="I love nothing more in life than creating and tinkering with the stuff around me. Over the years, this love has taken many different forms. It started out…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Stonelinks"/><meta data-react-helmet="true" name="twitter:title" content="Windows Based Webcam Control Software"/><meta data-react-helmet="true" name="twitter:description" content="I love nothing more in life than creating and tinkering with the stuff around me. Over the years, this love has taken many different forms. It started out…"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="icon" href="/favicon-32x32.png?v=a9c5f575d56c187d2a89d7544220474f" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=a9c5f575d56c187d2a89d7544220474f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=a9c5f575d56c187d2a89d7544220474f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=a9c5f575d56c187d2a89d7544220474f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=a9c5f575d56c187d2a89d7544220474f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=a9c5f575d56c187d2a89d7544220474f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=a9c5f575d56c187d2a89d7544220474f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=a9c5f575d56c187d2a89d7544220474f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=a9c5f575d56c187d2a89d7544220474f"/><link as="script" rel="preload" href="/webpack-runtime-13ae90b07d477eddbeb1.js"/><link as="script" rel="preload" href="/framework-8795d49c91212ecb2199.js"/><link as="script" rel="preload" href="/app-a78a0b481d139536ec8e.js"/><link as="script" rel="preload" href="/commons-ad582a6a95ece5acd59a.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-tsx-069185557d22318b8f04.js"/><link as="fetch" rel="preload" href="/page-data/2010-09-29-windows-based-webcam-control-software/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1632011873.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2841359383.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="global-wrapper" data-is-root-path="false"><header class="global-header"><div data-gatsby-image-wrapper="" style="width:80px;height:80px" class="gatsby-image-wrapper header-img"><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#080808;width:80px;height:80px;position:relative"></div><picture><source type="image/avif" data-srcset="/static/a9c5f575d56c187d2a89d7544220474f/d9027/icon.avif 80w,/static/a9c5f575d56c187d2a89d7544220474f/8a7fe/icon.avif 160w" sizes="80px"/><source type="image/webp" data-srcset="/static/a9c5f575d56c187d2a89d7544220474f/a5f1e/icon.webp 80w,/static/a9c5f575d56c187d2a89d7544220474f/36fad/icon.webp 160w" sizes="80px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="80px" decoding="async" loading="lazy" data-src="/static/a9c5f575d56c187d2a89d7544220474f/15e82/icon.png" data-srcset="/static/a9c5f575d56c187d2a89d7544220474f/15e82/icon.png 80w,/static/a9c5f575d56c187d2a89d7544220474f/e85d4/icon.png 160w" alt="Logo"/></picture><noscript><picture><source type="image/avif" srcSet="/static/a9c5f575d56c187d2a89d7544220474f/d9027/icon.avif 80w,/static/a9c5f575d56c187d2a89d7544220474f/8a7fe/icon.avif 160w" sizes="80px"/><source type="image/webp" srcSet="/static/a9c5f575d56c187d2a89d7544220474f/a5f1e/icon.webp 80w,/static/a9c5f575d56c187d2a89d7544220474f/36fad/icon.webp 160w" sizes="80px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="80px" decoding="async" loading="lazy" src="/static/a9c5f575d56c187d2a89d7544220474f/15e82/icon.png" srcSet="/static/a9c5f575d56c187d2a89d7544220474f/15e82/icon.png 80w,/static/a9c5f575d56c187d2a89d7544220474f/e85d4/icon.png 160w" alt="Logo"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div><h1 class="header-link-home"><a href="/">Stonelinks</a></h1><span><a class="header-link-nav" href="/">Home</a> | <a class="header-link-nav" href="/todo">Posts</a> | <a class="header-link-nav" href="/todo">Projects</a> | <a class="header-link-nav" href="/todo">About</a></span></header><main><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header><h1 itemProp="headline">Windows Based Webcam Control Software</h1><p>September 29, 2010</p></header><section itemProp="articleBody"><p>I love nothing more in life than creating and tinkering with the stuff around me. Over the years, this love has taken many different forms. It started out somewhere in elementary school with Legos and taking my toys apart (much to the chagrin of my loving parents). Today it has evolved over the years into weekend projects such as the I’m about to tell you about.</p>
<p>One weekend early in the semester, I found myself with some rare free time and so I chose to make my own internet-aware pan-tilt fixture for my webcam. To my room mates <a href="http://en.wikipedia.org/wiki/Sarcasm">delight</a>, I have placed the controls to this camera on this website.</p>
<p>Projects such as this are just the kind of thing that I love taking time to do. They span the full stack, and involve concepts that go from very low level micro controller programming to high level web programming, using all sorts of code and hardware as in between. It requires quite a lot of different skill sets and knowledge of systems integration for this to work. Anyhow enough self-aggrandizing, I’ll describe how I did it starting very low level at the and working my way up.</p>
<h3>Hardware</h3>
<p><img src="/posts/windows-based-webcam-control-software/2010-02-08-193359-150x150.jpg" alt=""></p>
<p>This summer I came into possession of an <a href="http://www.arduino.cc/">Arduino</a> micro controller and <a href="http://www.rcuniverse.com/product_guide/servoprofile.cfm?servo_id=67">some servos</a>. As you can see from the pictures, I connected the servos up to the micro controller, making Y-cables for the power, ground, and signal pins of the servos. I also added a laser diode for good measure.</p>
<p>The servo signal pins were wired to the digital I/O ports on the arduino. I stuffed the Arduino in a metal box I had lying around and hot glued everything together. Predictably, the webcam itself didn’t require much work. It was actually given to me for free! (previous owner couldn’t find drivers for it). I just ripped the stand off of it and glued it to the servos. All in all, this was a cheap and simple that has performed very well for what it was designed to do.</p>
<h3>Microcontroller Code</h3>
<p>I wrote the following code to establish basic control of the Arduino over its USB serial adapter. The servos are controlled using a technique called pulse width modulation (PWM). The comments explain what is going on, but for further background reading you can check out <a href="http://en.wikipedia.org/wiki/Pulse-width_modulation">this</a>. It also uses EEPROM to store the position of the camera between power cycles and resets. For some background about what EEPROM is check out <a href="http://en.wikipedia.org/wiki/EEPROM">this</a>.</p>
<div class="gatsby-highlight" data-language="c"><pre class="language-c"><code class="language-c"><span class="token comment">/*
 * File:            pantilt.c
 * Description:     A program for controlling
 *                  servos for use on a pan / tilt
 *                  module on my robot
 * Author:          Lucas Doyle (lucas.p.doyle@gmail.com)
 * Creation Date:   October 16, 2009
 * Revision Date:   Jan 31, 2010
 */</span>

<span class="token comment">// Since the Arduino resets itself every time a serial connection is</span>
<span class="token comment">// made in windows (if you're writing characters from PHP or something),</span>
<span class="token comment">// I have chosen to use the Arduinos EEPROM to store the positions</span>
<span class="token comment">// between resets. Therefore we include the EEPROM header.</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token expression">EEPROM</span></span>

<span class="token comment">// variables dealing with the pins</span>
<span class="token keyword">char</span> servoPinX    <span class="token operator">=</span>  <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token comment">// control pin for the first servo</span>
<span class="token keyword">char</span> servoPinY    <span class="token operator">=</span>  <span class="token number">3</span><span class="token punctuation">;</span>    <span class="token comment">// control pin for the second</span>
<span class="token keyword">char</span> laserpin     <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>    <span class="token comment">// the camera has a little laser diode on it</span>

<span class="token comment">// PWM variables</span>
<span class="token keyword">int</span> minPulseX    <span class="token operator">=</span> <span class="token number">600</span><span class="token punctuation">;</span>  <span class="token comment">// minimum servo position</span>
<span class="token keyword">int</span> maxPulseX    <span class="token operator">=</span> <span class="token number">2400</span><span class="token punctuation">;</span> <span class="token comment">// maximum servo position</span>
<span class="token keyword">int</span> minPulseY    <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span>   <span class="token comment">// same thing for other servo</span>
<span class="token keyword">int</span> maxPulseY    <span class="token operator">=</span> <span class="token number">1850</span><span class="token punctuation">;</span>
<span class="token keyword">char</span> turnRate    <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>  <span class="token comment">// servo turn rate increment (larger value, faster rate)</span>
<span class="token keyword">char</span> refreshTim  <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>   <span class="token comment">// time (ms) between pulses (50Hz)</span>

<span class="token comment">// The Arduino will calculate these values</span>
<span class="token keyword">int</span> centerServoX<span class="token punctuation">;</span>         <span class="token comment">// center servo position</span>
<span class="token keyword">int</span> centerServoY<span class="token punctuation">;</span>
<span class="token keyword">int</span> pulseWidthX<span class="token punctuation">;</span>          <span class="token comment">// servo pulse width</span>
<span class="token keyword">int</span> pulseWidthY<span class="token punctuation">;</span>
<span class="token keyword">char</span> moveServo<span class="token punctuation">;</span>            <span class="token comment">// raw user input</span>

<span class="token keyword">long</span> lastPulse   <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token comment">// recorded time (ms) of the last pulse</span>

<span class="token comment">// mode variables</span>
<span class="token keyword">int</span> laseron      <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token comment">// start out with the laser off by default</span>

<span class="token comment">// party mode, some stupid idea i had to have the camera</span>
<span class="token comment">// spaz out and strobe the laser, has not been written yet</span>
<span class="token comment">// because i have not had time</span>
<span class="token keyword">int</span> partymode    <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">// This function writes an int to eeprom at p_address</span>
<span class="token comment">// Adapted from Marc Cardinals work:</span>
<span class="token comment">// http://blog.ncode.ca/wp-content/uploads/2008/08/eeprom-int-readwrite.pde</span>
<span class="token keyword">void</span> <span class="token function">EEPROMWriteInt</span><span class="token punctuation">(</span><span class="token keyword">int</span> p_address<span class="token punctuation">,</span> <span class="token keyword">int</span> p_value<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  byte lowByte <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p_value <span class="token operator">>></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  byte highByte <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p_value <span class="token operator">>></span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  EEPROM<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>p_address<span class="token punctuation">,</span> lowByte<span class="token punctuation">)</span><span class="token punctuation">;</span>
  EEPROM<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>p_address <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> highByte<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// This function reads the int back</span>
<span class="token comment">// Also adapted from Marc Cardinals work:</span>
<span class="token comment">// http://blog.ncode.ca/wp-content/uploads/2008/08/eeprom-int-readwrite.pde</span>
<span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token function">EEPROMReadInt</span><span class="token punctuation">(</span><span class="token keyword">int</span> p_address<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  byte lowByte <span class="token operator">=</span> EEPROM<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>p_address<span class="token punctuation">)</span><span class="token punctuation">;</span>
  byte highByte <span class="token operator">=</span> EEPROM<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>p_address <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>lowByte <span class="token operator">&lt;&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>highByte <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xFF00</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">// Set up servo and laser pins as an output</span>
  <span class="token function">pinMode</span><span class="token punctuation">(</span>servoPinX<span class="token punctuation">,</span> OUTPUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">pinMode</span><span class="token punctuation">(</span>laserpin<span class="token punctuation">,</span> OUTPUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">pinMode</span><span class="token punctuation">(</span>servoPinY<span class="token punctuation">,</span> OUTPUT<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// calculate center positions for both servos</span>
  centerServoX <span class="token operator">=</span> maxPulseX <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>maxPulseX <span class="token operator">-</span> minPulseX<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  centerServoY <span class="token operator">=</span> maxPulseY <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>maxPulseY <span class="token operator">-</span> minPulseY<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">280</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// If you're running this for the first time on your arduino,</span>
  <span class="token comment">// uncomment the next two lines to initialize the EEPROM</span>
  <span class="token comment">// EEPROMWriteInt(0, centerServoX);</span>
  <span class="token comment">// EEPROMWriteInt(2, centerServoY);</span>

  pulseWidthX <span class="token operator">=</span> <span class="token function">EEPROMReadInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  pulseWidthY <span class="token operator">=</span> <span class="token function">EEPROMReadInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// begin serial communication</span>
  Serial<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token number">9600</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//Serial.println("Arduino Serial Pan/tilt Control");</span>
  <span class="token comment">//Serial.println("Standard WASD to move, spacebar to center");</span>
  <span class="token comment">//Serial.println("L toggles the laser, TFGH goes to the extremes");</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">loop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">// wait for serial input</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Serial<span class="token punctuation">.</span><span class="token function">available</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// read the incoming byte:</span>
    moveServo <span class="token operator">=</span> Serial<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// if party mode is off, read in commands</span>
    <span class="token comment">//if (partymode == 0)</span>
    <span class="token punctuation">{</span>
      <span class="token comment">//if (moveServo == (char) " ") {/*nothing happens*/}</span>

      <span class="token comment">// move left</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>moveServo <span class="token operator">==</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> pulseWidthX <span class="token operator">=</span> pulseWidthX <span class="token operator">-</span> turnRate<span class="token punctuation">;</span> <span class="token punctuation">}</span>

      <span class="token comment">// move right</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>moveServo <span class="token operator">==</span> <span class="token string">'d'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> pulseWidthX <span class="token operator">=</span> pulseWidthX <span class="token operator">+</span> turnRate<span class="token punctuation">;</span> <span class="token punctuation">}</span>

      <span class="token comment">// move up</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>moveServo <span class="token operator">==</span> <span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> pulseWidthY <span class="token operator">=</span> pulseWidthY <span class="token operator">-</span> turnRate<span class="token punctuation">;</span> <span class="token punctuation">}</span>

      <span class="token comment">// move down</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>moveServo <span class="token operator">==</span> <span class="token string">'s'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> pulseWidthY <span class="token operator">=</span> pulseWidthY <span class="token operator">+</span> turnRate<span class="token punctuation">;</span> <span class="token punctuation">}</span>

      <span class="token comment">// center</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>moveServo <span class="token operator">==</span> <span class="token string">'c'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> pulseWidthX <span class="token operator">=</span> centerServoX<span class="token punctuation">;</span> pulseWidthY <span class="token operator">=</span> centerServoY<span class="token punctuation">;</span><span class="token punctuation">}</span>

      <span class="token comment">// move hard left</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>moveServo <span class="token operator">==</span> <span class="token string">'f'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>pulseWidthX <span class="token operator">=</span> minPulseX<span class="token punctuation">;</span> <span class="token punctuation">}</span>

      <span class="token comment">// move hard right</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>moveServo <span class="token operator">==</span> <span class="token string">'h'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>pulseWidthX <span class="token operator">=</span> maxPulseX<span class="token punctuation">;</span> <span class="token punctuation">}</span>

      <span class="token comment">// move hard up</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>moveServo <span class="token operator">==</span> <span class="token string">'t'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>pulseWidthY <span class="token operator">=</span> minPulseY<span class="token punctuation">;</span> <span class="token punctuation">}</span>

      <span class="token comment">// move hard down</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>moveServo <span class="token operator">==</span> <span class="token string">'g'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>pulseWidthY <span class="token operator">=</span> maxPulseY<span class="token punctuation">;</span> <span class="token punctuation">}</span>

      <span class="token comment">// toggle the laser</span>
      <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>moveServo <span class="token operator">==</span> <span class="token string">'l'</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>laseron <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">digitalWrite</span><span class="token punctuation">(</span>laserpin<span class="token punctuation">,</span> HIGH<span class="token punctuation">)</span><span class="token punctuation">;</span> laseron <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>laseron <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">digitalWrite</span><span class="token punctuation">(</span>laserpin<span class="token punctuation">,</span> LOW<span class="token punctuation">)</span><span class="token punctuation">;</span> laseron <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// however if party mode is enabled</span>
    <span class="token comment">//else if (partymode == 1)</span>
    <span class="token comment">//{</span>
      <span class="token comment">// do some awesome stuff (not yet implemented)</span>
    <span class="token comment">//  Serial.print("Party!!! ");</span>
    <span class="token comment">//}</span>

    <span class="token comment">// party mode</span>
    <span class="token comment">//else if (moveServo == 'p')</span>
    <span class="token comment">//{</span>
    <span class="token comment">//  if (partymode == 0) { partymode = 1; }</span>
    <span class="token comment">//  else if (partymode == 1) { partymode = 0; }</span>
    <span class="token comment">//}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// stop servo pulse at min and max</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>pulseWidthX <span class="token operator">></span> maxPulseX<span class="token punctuation">)</span> <span class="token punctuation">{</span> pulseWidthX <span class="token operator">=</span> maxPulseX<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>pulseWidthX <span class="token operator">&lt;</span> minPulseX<span class="token punctuation">)</span> <span class="token punctuation">{</span> pulseWidthX <span class="token operator">=</span> minPulseX<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>pulseWidthY <span class="token operator">></span> maxPulseY<span class="token punctuation">)</span> <span class="token punctuation">{</span> pulseWidthY <span class="token operator">=</span> maxPulseY<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>pulseWidthY <span class="token operator">&lt;</span> minPulseY<span class="token punctuation">)</span> <span class="token punctuation">{</span> pulseWidthY <span class="token operator">=</span> minPulseY<span class="token punctuation">;</span> <span class="token punctuation">}</span>

  <span class="token comment">// print pulseWidth back to the Serial Monitor (uncomment to debug)</span>
  <span class="token comment">// Serial.print("Pulse Width: ");</span>
  <span class="token comment">// Serial.print(pulseWidth);</span>
  <span class="token comment">// Serial.println("us");   // microseconds</span>

  <span class="token comment">// pulse the servo every 20 ms (refreshTime) with current pulseWidth</span>
  <span class="token comment">// this will hold the servo's position if unchanged, or move it if changed</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> lastPulse <span class="token operator">>=</span> refreshTime<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token function">EEPROMWriteInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> pulseWidthX<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">EEPROMWriteInt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> pulseWidthY<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">digitalWrite</span><span class="token punctuation">(</span>servoPinX<span class="token punctuation">,</span> HIGH<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// start the pulse</span>
    <span class="token function">delayMicroseconds</span><span class="token punctuation">(</span>pulseWidthX<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// pulse width</span>
    <span class="token function">digitalWrite</span><span class="token punctuation">(</span>servoPinX<span class="token punctuation">,</span> LOW<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// end the pulse</span>

    <span class="token function">digitalWrite</span><span class="token punctuation">(</span>servoPinY<span class="token punctuation">,</span> HIGH<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// start the pulse for servo 2</span>
    <span class="token function">delayMicroseconds</span><span class="token punctuation">(</span>pulseWidthY<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// pulse width</span>
    <span class="token function">digitalWrite</span><span class="token punctuation">(</span>servoPinY<span class="token punctuation">,</span> LOW<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// stop the pulse</span>

    lastPulse <span class="token operator">=</span> <span class="token function">millis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// save the time of the last pulse</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h3>Establishing Serial Communication</h3>
<p>If you load the above code into the Arduino’s IDE and flash it to your microcontroller, you end up with a nice, intuitive way of manually controlling your pan / tilt mechanism. You can try things out by opening the Serial Monitor in the Arduino IDE and moving around using WASD, or move to the extremes using TFGH. Pressing ‘C’ centers the camera back and ‘L’ <a href="http://spf.fotolog.com/photo/47/10/95/vanguardista2104/1211331863_f.jpg">fires the laser</a>. Arguably, you could stop here and technically still have a way of controlling the camera over the internet with the power of linux. All one would need to do is open up a terminal or ssh into the machine and run the following command:</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"> ~$ <span class="token function">screen</span> /dev/ttyUSB0</code></pre></div>
<p>This was not good enough for me though, as I wanted to control this through a web browser, which brings us to…</p>
<h3>The Web Server</h3>
<p><img src="/posts/windows-based-webcam-control-software/2010-02-08-193241-150x150.jpg" alt=""></p>
<p>The Arduino is cool and all, but since the ultimate goal of this project is to control it over the internet, having a web server is an obvious requirement. Unfortunately for me, my web server also happens to be my self-built desktop that I use for almost all my other engineering work and day to day activities. Because of this, I need access to few windows only applications (Solidworks, LabVIEW, Photoshop, Steam, etc..) which rules out any linux server platforms if I want 100% uptime. This is an unfortunate constraint that caused me quite a lot of headaches down the line. In the future when I have another computer to spare and improve on this project, I will use the <a href="http://blog.taragana.com/wp-content/uploads/2008/03/linux-logo.jpg">right tool</a> for the job.</p>
<p>After all that rambling, you’re probably wondering how I have my web server configured. The only relevant details are that I am running stock <a href="http://www.wampserver.com/en/">WampServer</a> with PHP 5.3.0 with short tags enabled.</p>
<h3>Nightmare in PHP land</h3>
<p>I thought this would be easy. Since PHP is a server side scripting language, it has libraries that allow it to read and write to and from serial ports. So one would think that something like the following would work:</p>
<div class="gatsby-highlight" data-language="php"><pre class="language-php"><code class="language-php"><span class="token variable">$fp</span> <span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"COM3"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">,</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// write your character to the Arduino here</span>
<span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>However, for reasons I do not completely understand, this did not work for me under Windows 7, but it did with Linux (substituting COM3 for /dev/ttyUSB0). This problem persisted, as I also tried using the <a href="http://www.phpclasses.org/browse/package/3679.html">PHP serial class</a>, but it too proved to be equally as ineffective. I finally circumvented the need for PHP to communicate with the COM port entirely by compiling several very basic exe’s in <a href="http://processing.org/">processing</a> that sent individual character commands to the Arduino and then called them in PHP using the exec() function.</p>
<p>While extremely inefficient, this was the quickest, most reliable solution to my problem. Of course, this would all have been avoided in the first place had I been using Linux, as PHP has no problem writing to /dev/ttyUSB0 like it would a normal file in Linux.</p>
<h3>Building the Webpage</h3>
<p>By accessing the <a href="http://www.w3schools.com/PHP/php_get.asp">PHP $_GET</a> array, I was able to map incoming GET requests to different URLS to control what commands were sent to the camera. The PHP included in the header of the page is shown here:</p>
<div class="gatsby-highlight" data-language="php"><pre class="language-php"><code class="language-php"><span class="token comment">// check the GET action var to see if an action is to be performed</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'action'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token comment">// action required! build our command...</span>
   <span class="token variable">$basecmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"F:\\wamp\\www\\luke\\Projects\\personal_robot\\personal robot\\commands\\"</span><span class="token punctuation">;</span>
   <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token variable">$basecmd</span> <span class="token operator">.</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'action'</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\\application.windows\\"</span> <span class="token operator">.</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'action'</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">".exe"</span><span class="token punctuation">;</span>
   <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>And the HTML for the rest of the page is simply a 3x3 table with some hyperlinks to the right URLs with things like <code class="language-text">?action=up</code>, <code class="language-text">?action=down</code>, ect. placed in the right spot.</p>
<h3>Webcam</h3>
<p>To manage the webcam feed, I am using a program called <a href="http://www.lundie.ca/fwink/">Fwink</a> to take a picture every second and then using AJAX to automatically refresh the image once the page is loaded. However, there are many ways to manage a webcam feed and the details of how you do it is out of the scope of what I’m talking about here.</p>
<h2>Conclusions and Future Improvements</h2>
<p>As expected, performance with this setup is less than impressive, but this was more a learning exercise than it was a perfect execution. I have no doubts in my mind that the low performance is due to the wonky way in which I have to execute system calls to run the Processing exes. For the future, as this is a rough prototype, a lot can be improved / simplified by moving to Linux.</p>
<p>Additionally, this is the vision component to my yet-to-be-completed personal robot, and its brains (a first generation ASUS eeepc netbook) are currently on loan to a friend of mine. Next time I see him I’ll get the machine back and we’ll start cooking with gas! (and by gas I mean Linux).</p></section><hr/><footer><div class="bio"><div data-gatsby-image-wrapper="" style="width:50px;height:50px" class="gatsby-image-wrapper bio-avatar"><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#b8a878;width:50px;height:50px;position:relative"></div><picture><source type="image/avif" data-srcset="/static/18ab94594e9cb453626106dd881f6958/d4bf4/author.avif 50w,/static/18ab94594e9cb453626106dd881f6958/ee81f/author.avif 100w" sizes="50px"/><source type="image/webp" data-srcset="/static/18ab94594e9cb453626106dd881f6958/3faea/author.webp 50w,/static/18ab94594e9cb453626106dd881f6958/6a679/author.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" data-src="/static/18ab94594e9cb453626106dd881f6958/e5610/author.png" data-srcset="/static/18ab94594e9cb453626106dd881f6958/e5610/author.png 50w,/static/18ab94594e9cb453626106dd881f6958/e9b55/author.png 100w" alt="Profile picture"/></picture><noscript><picture><source type="image/avif" srcSet="/static/18ab94594e9cb453626106dd881f6958/d4bf4/author.avif 50w,/static/18ab94594e9cb453626106dd881f6958/ee81f/author.avif 100w" sizes="50px"/><source type="image/webp" srcSet="/static/18ab94594e9cb453626106dd881f6958/3faea/author.webp 50w,/static/18ab94594e9cb453626106dd881f6958/6a679/author.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" src="/static/18ab94594e9cb453626106dd881f6958/e5610/author.png" srcSet="/static/18ab94594e9cb453626106dd881f6958/e5610/author.png 50w,/static/18ab94594e9cb453626106dd881f6958/e9b55/author.png 100w" alt="Profile picture"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div><div>Written by <strong>Lucas Doyle</strong>, <!-- -->an engineer living in San Francisco</div><div><a href="/todo">About</a> | <a href="https://twitter.com/Stonelinks">Twitter</a> | <a href="https://github.com/Stonelinks">Github</a> | <a href="http://www.linkedin.com/pub/lucas-doyle/25/550/169">Linkedin</a> | <a href="https://www.youtube.com/c/LukeDoyle1">Youtube</a></div></div></footer></article><nav class="blog-post-nav"><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li></li><li><a rel="next" href="/2010-11-11-door-mounted-roboschwarzenegger/">Door Mounted Robo Schwarzenegger<!-- --> →</a></li></ul></nav></main><footer>© <!-- -->2021</footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2010-09-29-windows-based-webcam-control-software/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-8cea5a333273acb23afa.js"],"app":["/app-a78a0b481d139536ec8e.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-209e1e84a63e4b76b8e6.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-2f5e5dc4ca699938049c.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-d27cb93190534cda5d35.js"],"component---src-templates-blog-post-tsx":["/component---src-templates-blog-post-tsx-069185557d22318b8f04.js"]};/*]]>*/</script><script src="/polyfill-8cea5a333273acb23afa.js" nomodule=""></script><script src="/component---src-templates-blog-post-tsx-069185557d22318b8f04.js" async=""></script><script src="/commons-ad582a6a95ece5acd59a.js" async=""></script><script src="/app-a78a0b481d139536ec8e.js" async=""></script><script src="/framework-8795d49c91212ecb2199.js" async=""></script><script src="/webpack-runtime-13ae90b07d477eddbeb1.js" async=""></script></body></html>